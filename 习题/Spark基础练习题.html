<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>

<link href='file://C://Users//HP//AppData//Roaming//Typora/themes/vue/fonts.css' rel='stylesheet' type='text/css' /><style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color:#ffffff; --text-color:#333333; --select-text-bg-color:#B5D6FC; --select-text-font-color:auto; --monospace:"Lucida Console",Consolas,"Courier",monospace; --title-bar-height:20px; }
.mac-os-11 { --title-bar-height:28px; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
body { margin: 0px; padding: 0px; height: auto; inset: 0px; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; tab-size: 4; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror-linenumber { user-select: none; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-fences-adv-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; padding-top: 0px; border-color: transparent !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
  .typora-export-show-outline .typora-export-sidebar { display: none; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.8; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
mark { background: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
.md-expand mark .md-meta { opacity: 0.3 !important; }
mark .md-meta { color: rgb(0, 0, 0); }
@media print {
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill); }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-require-zoom-fix { height: auto; margin-top: 16px; margin-bottom: 16px; }
.md-require-zoom-fix foreignobject { font-size: var(--mermaid-font-zoom); }
.md-fences.md-fences-math { font-size: 1em; }
.md-fences-advanced:not(.md-focus) { padding: 0px; white-space: nowrap; border: 0px; }
.md-fences-advanced:not(.md-focus) { background: inherit; }
.typora-export-show-outline .typora-export-content { max-width: 1440px; margin: auto; display: flex; flex-direction: row; }
.typora-export-sidebar { width: 300px; font-size: 0.8rem; margin-top: 80px; margin-right: 18px; }
.typora-export-show-outline #write { --webkit-flex:2; flex: 2 1 0%; }
.typora-export-sidebar .outline-content { position: fixed; top: 0px; max-height: 100%; overflow: hidden auto; padding-bottom: 30px; padding-top: 60px; width: 300px; }
@media screen and (max-width: 1024px) {
  .typora-export-sidebar, .typora-export-sidebar .outline-content { width: 240px; }
}
@media screen and (max-width: 800px) {
  .typora-export-sidebar { display: none; }
}
.outline-content li, .outline-content ul { margin-left: 0px; margin-right: 0px; padding-left: 0px; padding-right: 0px; list-style: none; }
.outline-content ul { margin-top: 0px; margin-bottom: 0px; }
.outline-content strong { font-weight: 400; }
.outline-expander { width: 1rem; height: 1.42857rem; position: relative; display: table-cell; vertical-align: middle; cursor: pointer; padding-left: 4px; }
.outline-expander::before { content: ""; position: relative; font-family: Ionicons; display: inline-block; font-size: 8px; vertical-align: middle; }
.outline-item { padding-top: 3px; padding-bottom: 3px; cursor: pointer; }
.outline-expander:hover::before { content: ""; }
.outline-h1 > .outline-item { padding-left: 0px; }
.outline-h2 > .outline-item { padding-left: 1em; }
.outline-h3 > .outline-item { padding-left: 2em; }
.outline-h4 > .outline-item { padding-left: 3em; }
.outline-h5 > .outline-item { padding-left: 4em; }
.outline-h6 > .outline-item { padding-left: 5em; }
.outline-label { cursor: pointer; display: table-cell; vertical-align: middle; text-decoration: none; color: inherit; }
.outline-label:hover { text-decoration: underline; }
.outline-item:hover { border-color: rgb(245, 245, 245); background-color: var(--item-hover-bg-color); }
.outline-item:hover { margin-left: -28px; margin-right: -28px; border-left: 28px solid transparent; border-right: 28px solid transparent; }
.outline-item-single .outline-expander::before, .outline-item-single .outline-expander:hover::before { display: none; }
.outline-item-open > .outline-item > .outline-expander::before { content: ""; }
.outline-children { display: none; }
.info-panel-tab-wrapper { display: none; }
.outline-item-open > .outline-children { display: block; }
.typora-export .outline-item { padding-top: 1px; padding-bottom: 1px; }
.typora-export .outline-item:hover { margin-right: -8px; border-right: 8px solid transparent; }
.typora-export .outline-expander::before { content: "+"; font-family: inherit; top: -1px; }
.typora-export .outline-expander:hover::before, .typora-export .outline-item-open > .outline-item > .outline-expander::before { content: "−"; }
.typora-export-collapse-outline .outline-children { display: none; }
.typora-export-collapse-outline .outline-item-open > .outline-children, .typora-export-no-collapse-outline .outline-children { display: block; }
.typora-export-no-collapse-outline .outline-expander::before { content: "" !important; }
.typora-export-show-outline .outline-item-active > .outline-item .outline-label { font-weight: 700; }
.md-inline-math-container mjx-container { zoom: 0.95; }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background: inherit; }
.CodeMirror-scroll { overflow: auto hidden; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right: 1px solid rgb(221, 221, 221); background: inherit; white-space: nowrap; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background: inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; outline: 0px; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: auto hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 10px; z-index: 3; overflow-y: hidden; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; background: 0px 0px !important; border: none !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; background: 0px 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; overflow-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; }
.CodeMirror-wrap pre { overflow-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right: 30px solid transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right: none; width: auto; }
.CodeMirror-linebackground { position: absolute; inset: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
span.cm-underlined { text-decoration: underline; }
span.cm-strikethrough { text-decoration: line-through; }
.cm-tw-syntaxerror { color: rgb(255, 255, 255); background-color: rgb(153, 0, 0); }
.cm-tw-deleted { text-decoration: line-through; }
.cm-tw-header5 { font-weight: 700; }
.cm-tw-listitem:first-child { padding-left: 10px; }
.cm-tw-box { border-style: solid; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-color: inherit; border-top-width: 0px !important; }
.cm-tw-underline { text-decoration: underline; }
@media print {
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


/* cyrillic-ext */
/* cyrillic */
/* greek-ext */
/* greek */
/* vietnamese */
/* latin-ext */
/* latin */
/* cyrillic-ext */
/* cyrillic */
/* greek-ext */
/* greek */
/* vietnamese */
/* latin-ext */
/* latin */
/* cyrillic-ext */
/* cyrillic */
/* greek-ext */
/* greek */
/* vietnamese */
/* latin-ext */
/* latin */
/* cyrillic-ext */
/* cyrillic */
/* greek-ext */
/* greek */
/* vietnamese */
/* latin-ext */
/* latin */
@font-face {
    font-family: 'Source Sans Pro';
    font-style: normal;
    font-weight: 600;
    src: local('Source Sans Pro SemiBold'), local('SourceSansPro-SemiBold'), url('file:///C://Users//HP//AppData//Roaming//Typora/themes/vue/6xKydSBYKcSV-LCoeQqfX1RYOo3i54rwlxdu.woff2') format('woff2');
    unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}@import '';

:root {
    --side-bar-bg-color: #1d1d1d;
    --control-text-color: #aaaaaa;
    --select-text-bg-color: hsl(153, 47%, 40%);
    --active-file-bg-color:  hsl(153, 47%, 40%);
    --select-text-font-color: #aaaaaa;
    --active-file-text-color: #eeeeee;
    --bg-color: #1d1d1d;
    --item-hover-bg-color: var(--select-text-bg-color);
    --text-color: #aaaaaa;
    --font-sans-serif: 'Source Sans Pro', sans-serif !important;
    --font-monospace: 'Fira Code', 'Roboto Mono', monospace !important;
}

.md-rawblock-control:not(.md-rawblock-tooltip) {
    background: #555;
    color: #eeeeee;
}

.md-rawblock-on-edit>.md-rawblock-tooltip, .md-rawblock:hover>.md-rawblock-container, .md-rawblock:hover>.md-rawblock-tooltip {
    background: #555;
    color: #eeeeee;
}

/* code color */
.cm-s-inner .cm-keyword {
    color: #bb7fc3
}

.cm-s-inner .cm-atom, .cm-s-inner.cm-atom {
    color: #9088cc
}

.cm-s-inner .cm-number {
    color: #88b2a1
}

.cm-s-inner .cm-def {
    color: #7f7fff
}

.cm-s-inner .cm-variable {
    color: #efefef
}

.cm-s-inner .cm-variable-2 {
    color: #7faad4
}

.cm-s-inner .cm-variable-3 {
    color: #7fc3aa
}

.cm-s-inner .cm-string {
    color: #d48888
}

.cm-s-inner .cm-property {
    color: #efefef
}

.cm-s-inner .cm-operator {
    color: #cb8c8c
}

.cm-s-inner .cm-comment, .cm-s-inner.cm-comment {
    color: hsl(0, 0%, 35%)
}

.cm-s-inner .cm-string-2 {
    color: #ffaa7f
}

.cm-s-inner .cm-meta {
    color: hsl(0, 0%, 33%)
}

.cm-s-inner .cm-qualifier {
    color: hsl(0, 0%, 33%)
}

.cm-s-inner .cm-builtin {
    color: #997fd4
}

.cm-s-inner .cm-bracket {
    color: #ccccbb
}

.cm-s-inner .cm-tag {
    color: #88bb7f
}

.cm-s-inner .cm-attribute {
    color: #7f7fe5
}

.cm-s-inner .cm-header, .cm-s-inner.cm-header {
    color: #7f7fff
}

.cm-s-inner .cm-quote, .cm-s-inner.cm-quote {
    color: #7fcc7f
}

.cm-s-inner .cm-hr, .cm-s-inner.cm-hr {
    color: hsl(0, 0%, 60%)
}

.cm-s-inner .cm-link, .cm-s-inner.cm-link {
    color: #7f7fe5
}

.cm-negative {
    color: #eea1a1
}

.cm-positive {
    color: #90cc90
}

.cm-header, .cm-strong {
    font-weight: 700
}

.cm-error {
    color: #ff7f7f
}

.cm-invalidchar {
    color: #ff7f7f
}

.cm-constant {
    color: #42b983
}

.cm-defined {
    color: #dac37f
}

div.CodeMirror span.CodeMirror-matchingbracket {
    color: #7fff7f
}

div.CodeMirror span.CodeMirror-nonmatchingbracket {
    color: #ff9090
}

.info-panel-tab:hover {
    color:  #42b983;
}

.outline-label:hover {
    text-decoration: none;
}

input {
    color: #42b983;
}

.info-panel-tab:hover {
    color:  #42b983;
}

.outline-label:hover {
    text-decoration: none;
}

input {
    color: #42b983;
}

.dropdown-menu>li>a:focus, .dropdown-menu>li>a:hover {
    background: var(--select-text-bg-color);
    color: #fff;
}

html {
    font-size: 16px;
}

body {
    font-family: var(--font-sans-serif);
    color: #eeeeee;
    background-color: #1f1f1f;
    -webkit-font-smoothing: antialiased;
    line-height: 1.6rem;
    letter-spacing: 0;
    margin: 0;
    overflow-x: hidden;
}

#write {
    max-width: 860px;
    margin: 0 auto;
    padding: 20px 30px 40px 30px;
    padding-top: 20px;
    padding-bottom: 100px;
}

#write p {
    /* text-indent: 2rem; */
    line-height: 1.6rem;
    word-spacing: .05rem;
}

#write ol li {
    padding-left: 0.5rem;
}

#write > ul:first-child,
#write > ol:first-child {
    margin-top: 30px;
}

body > *:first-child {
    margin-top: 0 !important;
}

body > *:last-child {
    margin-bottom: 0 !important;
}

a {
    color: #42b983;
    font-weight: 600;
    padding: 0px 2px;
    text-decoration: none;
}

h1,
h2,
h3,
h4,
h5,
h6 {
    position: relative;
    margin-top: 1rem;
    margin-bottom: 1rem;
    font-weight: bold;
    line-height: 1.4;
    cursor: text;
}

h1:hover a.anchor,
h2:hover a.anchor,
h3:hover a.anchor,
h4:hover a.anchor,
h5:hover a.anchor,
h6:hover a.anchor {
    text-decoration: none;
}

h1 tt,
h1 code {
    font-size: inherit;
}

h2 tt,
h2 code {
    font-size: inherit;
}

h3 tt,
h3 code {
    font-size: inherit;
}

h4 tt,
h4 code {
    font-size: inherit;
}

h5 tt,
h5 code {
    font-size: inherit;
}

h6 tt,
h6 code {
    font-size: inherit;
}

h1 {
    padding-bottom: .4rem;
    font-size: 2.2rem;
    line-height: 1.3;
}

h2 {
    font-size: 1.75rem;
    line-height: 1.225;
    margin: 35px 0px 15px 0px;
    padding-bottom: 0.5em;
    border-bottom: 2px solid hsl(0, 0%, 20%);
}

h3 {
    font-size: 1.4rem;
    line-height: 1.43;
    margin: 20px 0px 7px 0px;
}

h4 {
    font-size: 1.2rem;
}

h5 {
    font-size: 1rem;
}

h6 {
    font-size: 1rem;
    color: hsl(0, 0%, 53%);
}

p,
blockquote,
ul,
ol,
dl,
table {
    margin: 0.8em 0;
}

li > ol,
li > ul {
    margin: 0 0;
}

hr {
    height: 2px;
    padding: 0;
    margin: 16px 0;
    background-color: hsl(0, 0%, 18%);
    border: 0 none;
    overflow: hidden;
    box-sizing: content-box;
}

body > h2:first-child {
    margin-top: 0;
    padding-top: 0;
}

body > h1:first-child {
    margin-top: 0;
    padding-top: 0;
}

body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0;
}

body > h3:first-child,
body > h4:first-child,
body > h5:first-child,
body > h6:first-child {
    margin-top: 0;
    padding-top: 0;
}

a:first-child h1,
a:first-child h2,
a:first-child h3,
a:first-child h4,
a:first-child h5,
a:first-child h6 {
    margin-top: 0;
    padding-top: 0;
}

h1 p,
h2 p,
h3 p,
h4 p,
h5 p,
h6 p {
    margin-top: 0;
}

li p.first {
    display: inline-block;
}

ul,
ol {
    padding-left: 30px;
}

ul:first-child,
ol:first-child {
    margin-top: 0;
}

ul:last-child,
ol:last-child {
    margin-bottom: 0;
}

blockquote {
    border-left: 4px solid #42b983;
    padding: 10px 0px 10px 15px;
    color: #eeeeee;
    background-color: rgba(66, 185, 131, .1);
}

table {
    font-family: var(--font-monospace);
    font-size: 0.85rem;
    padding: 0;
    overflow: hidden;
    word-break: initial;
}

table tr {
    border-top: 1px solid hsl(210, 10%, 11%);
    margin: 0;
    padding: 0;
}

table tr:nth-child(2n),
thead {
    /* background-color: hsl(0, 0%, 2%); */
    background-color: hsl(0, 0%, 10%);
}

table tr th {
    font-weight: bold;
    /* border: 1px solid hsl(210, 10%, 11%); */
    border: transparent;
    border-bottom: 0;
    text-align: left;
    margin: 0;
    padding: 6px 13px;
}

table tr td {
    /* border: 2px solid hsl(210, 10%, 11%); */
    /* border: 2px solid hsl(0, 0%, 4%); */
    border: 2px solid #1d1d1d;
    text-align: left;
    margin: 0;
    padding: 6px 13px;
}

table tr th:first-child,
table tr td:first-child {
    margin-top: 0;
}

table tr th:last-child,
table tr td:last-child {
    margin-bottom: 0;
}

#write table thead th {
    /* background-color: hsl(0, 0%, 5%); */
    background-color: hsl(0, 0%, 9%);
}

#write .CodeMirror-gutters {
    border-right: none;
}

#write .md-fences {
    border: 1px solid hsl(0, 0%, 11%);
    -webkit-font-smoothing: initial;
    margin: 0.8rem 0 !important;
    padding: 0.3rem 0rem !important;
    line-height: 1.43rem;
    color: hsl(0, 0%, 78%);
    background-color: hsl(0, 0%, 10%) !important;
    border-radius: 2px;
    font-family: var(--font-monospace);
    font-weight: bold;
    font-size: 0.85rem;
    word-wrap: normal;
}

#write .CodeMirror-wrap .CodeMirror-code pre {
    padding-left: 12px;
}

#write code, tt {
    padding: 2px 4px;
    border-radius: 2px;
    font-family: var(--font-monospace);
    font-weight: bold;
    font-size: 0.85rem;
    color: #f3b37f;
    background-color: hsla(0, 0%, 0%, 0.2);
}

tt {
    margin: 0 2px;
}

#write .md-footnote {
    background-color: hsla(0, 0%, 0%, 0.2);
    color: #f3b37f;
}

/* heighlight. */
#write mark {
    background-color: #EBFFEB;
    border-radius: 2px;
    padding: 2px 4px;
    margin: 0 2px;
    color: #222;
    font-weight: 500;
}

#write del {
    padding: 1px 2px;
}

.cm-s-inner .cm-link,
.cm-s-inner.cm-link {
    color: #22a2c9;
}

.cm-s-inner .cm-string {
    color: #22a2c9;
}

.md-task-list-item > input {
    margin-left: -1.3em;
}

@media screen and (min-width: 914px) {
    /*body {
        width: 854px;
        margin: 0 auto;
    }*/
}

@media print {
    html {
        font-size: 13px;
    }

    table,
    pre {
        page-break-inside: avoid;
    }

    pre {
        word-wrap: break-word;
    }
}

#write pre.md-meta-block {
    padding: 1rem;
    font-size: 85%;
    line-height: 1.45;
    background-color: hsl(0, 0%, 3%);
    border: 0;
    border-radius: 3px;
    color: hsl(0, 0%, 53%);
    margin-top: 0 !important;
}

.mathjax-block > .code-tooltip {
    bottom: .375rem;
}

#write > h3.md-focus:before {
    left: -1.5625rem;
    top: .375rem;
}

#write > h4.md-focus:before {
    left: -1.5625rem;
    top: .285714286rem;
}

#write > h5.md-focus:before {
    left: -1.5625rem;
    top: .285714286rem;
}

#write > h6.md-focus:before {
    left: -1.5625rem;
    top: .285714286rem;
}

.md-image > .md-meta {
    border-radius: 3px;
    font-family: var(--font-monospace);
    padding: 2px 0px 0px 4px;
    font-size: 0.9em;
    color: inherit;
}

.md-tag {
    color: inherit;
}

.md-toc {
    margin-top: 20px;
    padding-bottom: 20px;
}

.md-diagram-panel {
    position: static !important;
}

.sidebar-tabs {
    border-bottom: none;
}

#typora-quick-open {
    border: 1px solid #ddd;
    background-color: #f8f8f8;
}

#typora-quick-open-item {
    background-color: hsl(0, 0%, 2%);
    border-color: hsl(0, 0%, 0%) hsl(0, 0%, 10%) hsl(0, 0%, 10%) hsl(0, 0%, 7%);
    border-style: solid;
    border-width: 1px;
}

#md-notification:before {
    top: 10px;
}

/** focus mode */

.on-focus-mode blockquote {
    border-left-color: rgba(85, 85, 85, 0.12);
}

header,
.context-menu,
.megamenu-content,
footer {
    font-family: var(--font-sans-serif);
}

.file-node-content:hover .file-node-icon,
.file-node-content:hover .file-node-open-state {
    visibility: visible;
}

.mac-seamless-mode #typora-sidebar {
    background-color: hsl(0, 0%, 2%);
    background-color: var(--side-bar-bg-color);
}

.md-lang {
    color: #42b983;
}

.html-for-mac .context-menu {
    --item-hover-bg-color: hsl(215, 92%, 5%);
}

#typora-sidebar {
    font-family: var(--font-sans-serif);
    font-weight: bold;
}

.file-list-item-summary{
    font-family: var(--font-sans-serif);
    font-weight: 400;
}

.file-list-item {
    border-bottom: 0.15rem solid hsl(0, 0%, 18%);
}

.file-list-item.active {
    background: hsl(0, 0%, 15%) !important;
}

.file-node-background {
    height: 29px;
}

#toc-dropmenu {
    background: hsl(0, 0%, 18%) !important;
    font-weight: bold;
}

#toc-content {
    margin-top: 1.0rem;
    margin-bottom: 1.0rem;
}

#toc-content a:hover {
    text-decoration: none;
}

.outline-item {
    /* transition: color 150ms, background-color 150ms; */
    transition: color 150ms;
}

.outline-item:hover {
    background-color: rgba(0, 0, 0, 0.5);
    color: #42b983;
}

.sidebar-footer {
    border-top: 2px solid hsl(0, 0%, 15%) !important;
}

.footer-item:hover, .sidebar-footer-item:hover {
    background-color: rgba(0, 0, 0, 0.5) !important;
}

.file-tree-node.active>.file-node-background {
    background-color: hsl(0, 0%, 15%) !important;
}

.file-node-content:hover {
    color: #eeeeee;
}

html{
    background: #1f1f1f !important;
}

.outline-title-wrapper {
    display: none;
}

.dropdown-menu .divider {
    display: none;
    height: 2px;
    background-color: hsl(0, 0%, 13%);
}

.dropdown-menu>li>a {
    color: #eeeeee;
}

.autoComplt-hint {
    color: #42b983 !important;
    /* border-color: transparent !important */
}

.auto-suggest-container {
    color: #42b983 !important;
    font-family: var(--font-sans-serif);
    font-weight: bold !important;
    border-color: #42b983 !important;
    border-radius: 8px !important;
    border-width: 2px !important;
    margin-top: 5px;
    overflow: hidden !important;
    box-shadow: 0 0 1rem hsla(153, 47%, 49%, 0.3);
}

/* .auto-suggest-container li { */
    /* transition: all 150ms; */
    /* text-align: center !important; */
/* } */

.auto-suggest-container li:hover {
    color: #eeeeee !important;
    background-color: #42b983 !important;
    /* text-align: right !important; */
}

/* windows */
/* .modal-dialog { */
    /* color: #000; */
/* } */

.typora-sourceview-on #toggle-sourceview-btn{
    background-color: #42b983
}

/* cursor */
.CodeMirror.cm-s-typora-default div.CodeMirror-cursor {
    border-left: 5px solid #42b983;
}

.CodeMirror div.CodeMirror-cursor {
    border-left: 5px solid #42b983;
    z-index: 3;
}

/* selected text */
/* .CodeMirror-selecte { */
    /* background-color: hsla(153, 47%, 49%, 0.5) !important; */
    /* color: #eeeeee !important; */
/* } */

.ty-preferences {
    color: #aaaaaa;
}

.ty-preferences .btn-default:not([disabled]):hover {
    background-color: var(--active-file-bg-color);
    background-image: none;
    color: #fff;
}

.ty-preferences .search-hit {
    background: var(--select-text-bg-color)
}



mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}
 :root {--mermaid-font-zoom:1.8em ;} 
</style><title>Spark基础练习题</title>
</head>
<body class='typora-export os-windows'><div class='typora-export-content'>
<div id='write'  class=''><h1 id='spark基础小题'><span>Spark基础小题</span></h1><h2 id='选择题'><span>选择题</span></h2><p><span>1)Scala程序编译后的文件以什么结尾：</span>
<code>A、.class</code><span> B、java C、.scala D、.sc</span>
<span>A</span>
<span>2)以下哪种Scala方法可以正确计算数组a的长度：</span>
<span>A、count() B、take（1） C、tail(） </span><code>D、length()</code>
<span>D</span>
<span>3)Scala中如何取出字符串str的后4个字符作为输出？</span>
<span>A、str.get（str.length-5，str-1）B、str.tail（str.length-5，str.length-1）</span>
<code>C、str.substring（str.length-4，str.length）</code><span>D、str.cat（str.length-5，str.length-1）</span>
<span>C</span>
<span>4)下面哪个方法不是用于创建RDD？</span>
<span>A、makeRDD B、parallelize C、textFile </span><code>D、saveAsTextFile</code>
<span>D</span>
<span>5)下面哪个不是RDD的特点：</span>
<span>A、可分区 B、可序列化 </span><code>C、可修改</code><span> D、可持久化</span>
<span>C</span>
<span>6)下面哪一组全部都是Spark的转换操作：</span>
<span>A、map、take、reduceByKey</span>
<span>B、map、filter、collect</span>
<span>C、map、union、reduceByKey</span>
<code>D、jion、map、take</code>
<span>C</span>
<span>7)Spark SQL可以处理的数据源包括：</span>
<span>A、Hive表</span>
<span>B、数据文件、Hive表</span>
<span>C、数据文件、Hive表、RDD</span>
<code>D、数据文件、Hive表、RDD、外部数据库</code>
<span>D</span>
<span>8)关于DataFrame的说法错误的是：</span>
<span>A、DataFrame是由SchemaRDD发展而来</span>
<code>B、DataFrame直接继承了RDD</code>
<span>C、DataFrame实现了RDD的绝大多数功能</span>
<span>D、DataFrame是一个分布式Row对象的数据集合</span>
<span>B</span>
<span>9)DataFrame的groupBy方法返回的结果是什么类型：</span>
<span>A、DataFrame   B、Column   C、RDD   </span><code>D、GroupedData</code>
<span>D</span>
<span>10)Spark Job 默认的调度模式 ( )</span>
<code>A FIFO</code><span>   B FAIR   C 无   D 运行时指定</span>
<span>A</span>
<span>11)DataFrame 和 RDD 最大的区别 ( )</span>
<span>A.科学统计支持 </span><code>B.多了 schema</code><span> C.存储方式不一样 D.外部数据源支持</span>
<span>B</span>
<span>12)默认的存储级别 ( )</span>
<code>A MEMORY_ONLY</code><span> B MEMORY_ONLY_SER</span>
<span>C MEMORY_AND_DISK D MEMORY_AND_DISK_SER</span>
<span>A</span></p><h2 id='简答'><span>简答</span></h2><p><span>1)对比Hadoop 框架和Spark框架，Spark 有哪些优势？</span></p><blockquote><p><span>1）基于内存计算，减少低效的磁盘交互；</span></p><p><span>2）高效的调度算法，基于DAG ；</span></p><p><span>3）容错机制 Linage ，精华部分就是 DAG 和 Lingae </span></p></blockquote><ul><li><span>Spark的计算模式也是MapReduce，但不局限于Map和Reduce操作，还提供了集操作类型，编程模型比MapReduce更灵活。</span></li><li><span>Spark提供内存计算，中间结果直接放到内存中，带来了更高的迭代运算效率</span></li><li><span>Spark基于DAG的任务调度执行机制，要优于MapReduce的迭代执行机制</span></li></ul><p><span>2)什么是宽依赖，什么是窄依赖？哪些算子是宽依赖，哪些是窄依赖？</span></p><blockquote><p><span>RDD 和它依赖的parent RDD(s) 的关系有两种不同的类型，即窄依赖（ narrow dependency ）和宽依赖（ wide </span></p><p><span>dependency ）。 </span></p><p><span>1）窄依赖指的是每一个parent RDD 的 Partition 最多被子 RDD 的一个 Partition 使用</span></p><p><span>2）宽依赖指的是多个子 RDD 的 Partition 会依赖同一个 parent RDD 的 Partition </span></p></blockquote><ul><li><a href='https://blog.csdn.net/houmou/article/details/52531205?spm=1001.2101.3001.6650.9&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-9.no_search_link&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-9.no_search_link'><span>Spark 中的宽依赖和窄依赖</span></a></li><li><a href='https://blog.csdn.net/aoayyu826824/article/details/102345785'><span>算子的分类和 宽依赖算子、窄依赖算子</span></a></li></ul><p><span>3)简述spark的工作机制。</span></p><blockquote><p><span>答：</span></p><ol><li><span>用户在 client 端提交作业后，会由Driver 运行 main 方法并创建 spark context 上下文</span></li></ol><ol start='2' ><li><span>执行 rdd 算子，形成dag 图输入 dagscheduler </span></li><li><span>按照 rdd 之间的依赖关系划分stage 输入 task scheduler 。task scheduler 会将 stage 划分为 task set 分发到各个节点的executor 中执行。</span></li></ol></blockquote><p><span>4)简述RDD机制。</span></p><blockquote><p><span>答： </span></p><ol><li><p><span>rdd 分布式弹性数据集，简单的理解成一种数据结构，是spark 框架上的通用货币。</span></p><ol><li><span>所有算子都是基于rdd来执行的，不同的场景会有不同的rdd 实现类，但是都可以进行互相转换。</span></li></ol></li><li><p><span>rdd 执行过程中会形成dag 图，然后形成 lineage 保证容错性等。</span></p></li><li><p><span>从物理的角度来看rdd 存储的是 block 和 node之间的映射。</span></p></li></ol></blockquote><p><span>5)spark的有几种部署模式？简述每种模式特点。 P91</span></p><blockquote><p><span>1）</span><mark><span>本地模式</span></mark></p><p><span>Spark 不一定非要跑在hadoop 集群，可以在本地，起多个线程的方式来指定。将Spark 应用以多线程的方式直</span></p><p><span>接运行在本地，一般都是为了方便调试，本地模式分三类</span></p><p><span>· local ：只启动一个 executor </span></p><p><span>· local[k]: 启动 k 个 executor </span></p><p><span>· local[*] ：启动跟 cpu 数目相同的 executor 2571</span></p><p><span>2)</span><mark><span>standalone 模式</span></mark></p><p><span>分布式部署集群，自带完整的服务，资源管理和任务监控是 Spark 自己监控，这个模式也是其他模式的基础，</span></p><p><span>3)</span><mark><span>Spark on yarn 模式</span></mark></p><p><span>分布式部署集群，资源和任务监控交给 yarn 管理，但是目前仅支持粗粒度资源分配方式，包含 cluster 和 client</span></p><p><span>运行模式， cluster 适合生产， driver 运行在集群子节点，具有容错功能， client 适合调试， dirver 运行在客户</span></p><p><span>端。</span></p><p><span>4）</span><mark><span>Spark On Mesos 模式</span></mark></p><p><span>官方推荐这种模式（当然，原因之一是血缘关系）。正是由于 Spark 开发之初就考虑到支持 Mesos ，因此，目</span></p><p><span>前而言， Spark 运行在 Mesos 上会比运行在 YARN 上更加灵活，更加自然。</span></p></blockquote><ul><li><span>Local</span></li><li><span>Standalone</span></li><li><span>Spark on Mesos</span></li><li><span>Spark on YARN</span></li></ul><p><span>6)简述spark的优势和劣势。</span></p><blockquote><p><span>优势：</span></p><ul><li><span>1)速度快</span></li><li><span>2)其次， Spark 是一个灵活的运算框架，适合做批次处理、工作流、交互式分析、流量处理等不同类型的应用，因此 spark 也可以成为一个用途广泛的运算引擎，并在未来取代 MapReduce 的地位</span></li><li><span>3)最后， Spark 可以与 Hadoop 生态系统的很多组件互相操作。Spark 可以运行在新一代资源管理框架YARN 上，它还可以读取已有并存放在 Hadoop 上的数据，这是个非常大的优势</span></li></ul><p><span>劣势：</span></p><ul><li><span>1)稳定性方面</span></li><li><span>2)不能处理大数据</span></li><li><span>3)不能支持复杂的 SQL 统计</span></li></ul></blockquote><h1 id='spark基础练习题一）'><span>Spark基础练习题（一）</span></h1><h2 id='题目-1'><span>题目</span></h2><p><span>读取文件的数据test.txt</span>
<span>一共有多少个小于20岁的人参加考试？</span>
<span>一共有多少个等于20岁的人参加考试？</span>
<span>一共有多少个大于20岁的人参加考试？</span>
<span>一共有多个男生参加考试？</span>
<span>一共有多少个女生参加考试？</span>
<span>12班有多少人参加考试？</span>
<span>13班有多少人参加考试？</span>
<span>语文科目的平均成绩是多少？</span>
<span>数学科目的平均成绩是多少？</span>
<span>英语科目的平均成绩是多少？</span>
<span>单个人平均成绩是多少？</span>
<span>12班平均成绩是多少？</span>
<span>12班男生平均总成绩是多少？</span>
<span>12班女生平均总成绩是多少？</span>
<span>13班平均成绩是多少？</span>
<span>13班男生平均总成绩是多少？</span>
<span>13班女生平均总成绩是多少？</span>
<span>全校语文成绩最高分是多少？</span>
<span>12班语文成绩最低分是多少？</span>
<span>13班数学最高成绩是多少？</span>
<span>总成绩大于150分的12班的女生有几个？</span>
<span>总成绩大于150分，且数学大于等于70，且年龄大于等于19岁的学生的平均成绩是多少？</span></p><h2 id='数据-1'><span>数据</span></h2><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="ABAP" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="abap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.38889px; left: 11.9965px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">12</span> <span class="cm-error">宋江</span> <span class="cm-number">25</span> <span class="cm-error">男</span> <span class="cm-error">chinese</span> <span class="cm-number">50</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">12</span> <span class="cm-error">宋江</span> <span class="cm-number">25</span> <span class="cm-error">男</span> <span class="cm-error">math</span> <span class="cm-number">60</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">12</span> <span class="cm-error">宋江</span> <span class="cm-number">25</span> <span class="cm-error">男</span> <span class="cm-error">english</span> <span class="cm-number">70</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">12</span> <span class="cm-error">吴用</span> <span class="cm-number">20</span> <span class="cm-error">男</span> <span class="cm-error">chinese</span> <span class="cm-number">50</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">12</span> <span class="cm-error">吴用</span> <span class="cm-number">20</span> <span class="cm-error">男</span> <span class="cm-error">math</span> <span class="cm-number">50</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">12</span> <span class="cm-error">吴用</span> <span class="cm-number">20</span> <span class="cm-error">男</span> <span class="cm-error">english</span> <span class="cm-number">50</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">12</span> <span class="cm-error">杨春</span> <span class="cm-number">19</span> <span class="cm-error">女</span> <span class="cm-error">chinese</span> <span class="cm-number">70</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">12</span> <span class="cm-error">杨春</span> <span class="cm-number">19</span> <span class="cm-error">女</span> <span class="cm-error">math</span> <span class="cm-number">70</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">12</span> <span class="cm-error">杨春</span> <span class="cm-number">19</span> <span class="cm-error">女</span> <span class="cm-error">english</span> <span class="cm-number">70</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">13</span> <span class="cm-error">李逵</span> <span class="cm-number">25</span> <span class="cm-error">男</span> <span class="cm-error">chinese</span> <span class="cm-number">60</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">13</span> <span class="cm-error">李逵</span> <span class="cm-number">25</span> <span class="cm-error">男</span> <span class="cm-error">math</span> <span class="cm-number">60</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">13</span> <span class="cm-error">李逵</span> <span class="cm-number">25</span> <span class="cm-error">男</span> <span class="cm-error">english</span> <span class="cm-number">70</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">13</span> <span class="cm-error">林冲</span> <span class="cm-number">20</span> <span class="cm-error">男</span> <span class="cm-error">chinese</span> <span class="cm-number">50</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">13</span> <span class="cm-error">林冲</span> <span class="cm-number">20</span> <span class="cm-error">男</span> <span class="cm-error">math</span> <span class="cm-number">60</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">13</span> <span class="cm-error">林冲</span> <span class="cm-number">20</span> <span class="cm-error">男</span> <span class="cm-error">english</span> <span class="cm-number">50</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">13</span> <span class="cm-error">王英</span> <span class="cm-number">19</span> <span class="cm-error">女</span> <span class="cm-error">chinese</span> <span class="cm-number">70</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">13</span> <span class="cm-error">王英</span> <span class="cm-number">19</span> <span class="cm-error">女</span> <span class="cm-error">math</span> <span class="cm-number">80</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">13</span> <span class="cm-error">王英</span> <span class="cm-number">19</span> <span class="cm-error">女</span> <span class="cm-error">english</span> <span class="cm-number">70</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 410px;"></div><div class="CodeMirror-gutters" style="display: none; height: 410px;"></div></div></div></pre><h2 id='答案-1'><span>答案</span></h2><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="scala" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="scala"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.38889px; left: 11.9965px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><span><span>​</span>x</span></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">sc</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">SparkContext</span>(<span class="cm-keyword">new</span> <span class="cm-variable">SparkConf</span>().<span class="cm-variable">setMaster</span>(<span class="cm-string">"local[*]"</span>).<span class="cm-variable">setAppName</span>(<span class="cm-string">"test"</span>))</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1</span><span class="cm-variable">、读取文件的数据test</span>.<span class="cm-variable">txt</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">file</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">textFile</span>(<span class="cm-string">"test.txt"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">2</span><span class="cm-variable">、一共有多少个小于20岁的人参加考试</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">println</span>(<span class="cm-variable">file</span>.<span class="cm-variable">groupBy</span> { <span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> <span class="cm-keyword">val</span> <span class="cm-def">datas</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>); <span class="cm-variable">datas</span>(<span class="cm-number">0</span>) <span class="cm-operator">+</span> <span class="cm-string">"_"</span> <span class="cm-operator">+</span> <span class="cm-variable">datas</span>(<span class="cm-number">1</span>) <span class="cm-operator">+</span> <span class="cm-string">"_"</span> <span class="cm-operator">+</span> <span class="cm-variable">datas</span>(<span class="cm-number">2</span>) }.<span class="cm-variable">filter</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">_1</span>.<span class="cm-variable">split</span>(<span class="cm-string">"_"</span>)(<span class="cm-number">2</span>).<span class="cm-variable">toInt</span> <span class="cm-operator">&lt;</span> <span class="cm-number">20</span>).<span class="cm-variable">count</span>())</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">3</span><span class="cm-variable">、一共有多少个等于20岁的人参加考试</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">println</span>(<span class="cm-variable">file</span>.<span class="cm-variable">groupBy</span> { <span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> <span class="cm-keyword">val</span> <span class="cm-def">datas</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>); <span class="cm-variable">datas</span>(<span class="cm-number">0</span>) <span class="cm-operator">+</span> <span class="cm-string">"_"</span> <span class="cm-operator">+</span> <span class="cm-variable">datas</span>(<span class="cm-number">1</span>) <span class="cm-operator">+</span> <span class="cm-string">"_"</span> <span class="cm-operator">+</span> <span class="cm-variable">datas</span>(<span class="cm-number">2</span>) }.<span class="cm-variable">filter</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">_1</span>.<span class="cm-variable">split</span>(<span class="cm-string">"_"</span>)(<span class="cm-number">2</span>).<span class="cm-variable">toInt</span> <span class="cm-operator">==</span> <span class="cm-number">20</span>).<span class="cm-variable">count</span>())</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">4</span><span class="cm-variable">、一共有多少个大于20岁的人参加考试</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">println</span>(<span class="cm-variable">file</span>.<span class="cm-variable">groupBy</span> { <span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> <span class="cm-keyword">val</span> <span class="cm-def">datas</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>); <span class="cm-variable">datas</span>(<span class="cm-number">0</span>) <span class="cm-operator">+</span> <span class="cm-string">"_"</span> <span class="cm-operator">+</span> <span class="cm-variable">datas</span>(<span class="cm-number">1</span>) <span class="cm-operator">+</span> <span class="cm-string">"_"</span> <span class="cm-operator">+</span> <span class="cm-variable">datas</span>(<span class="cm-number">2</span>) }.<span class="cm-variable">filter</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">_1</span>.<span class="cm-variable">split</span>(<span class="cm-string">"_"</span>)(<span class="cm-number">2</span>).<span class="cm-variable">toInt</span> <span class="cm-operator">&gt;</span> <span class="cm-number">20</span>).<span class="cm-variable">count</span>())</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">5</span><span class="cm-variable">、一共有多个男生参加考试</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">println</span>(<span class="cm-variable">file</span>.<span class="cm-variable">groupBy</span> { <span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> <span class="cm-keyword">val</span> <span class="cm-def">datas</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>); <span class="cm-variable">datas</span>(<span class="cm-number">0</span>) <span class="cm-operator">+</span> <span class="cm-string">"_"</span> <span class="cm-operator">+</span> <span class="cm-variable">datas</span>(<span class="cm-number">1</span>) <span class="cm-operator">+</span> <span class="cm-string">"_"</span> <span class="cm-operator">+</span> <span class="cm-variable">datas</span>(<span class="cm-number">3</span>) }.<span class="cm-variable">filter</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">_1</span>.<span class="cm-variable">split</span>(<span class="cm-string">"_"</span>)(<span class="cm-number">2</span>).<span class="cm-variable">equals</span>(<span class="cm-string">"男"</span>)).<span class="cm-variable">count</span>())</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">6</span><span class="cm-variable">、一共有多少个女生参加考试</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">println</span>(<span class="cm-variable">file</span>.<span class="cm-variable">groupBy</span> { <span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> <span class="cm-keyword">val</span> <span class="cm-def">datas</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>); <span class="cm-variable">datas</span>(<span class="cm-number">0</span>) <span class="cm-operator">+</span> <span class="cm-string">"_"</span> <span class="cm-operator">+</span> <span class="cm-variable">datas</span>(<span class="cm-number">1</span>) <span class="cm-operator">+</span> <span class="cm-string">"_"</span> <span class="cm-operator">+</span> <span class="cm-variable">datas</span>(<span class="cm-number">3</span>) }.<span class="cm-variable">filter</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">_1</span>.<span class="cm-variable">split</span>(<span class="cm-string">"_"</span>)(<span class="cm-number">2</span>).<span class="cm-variable">equals</span>(<span class="cm-string">"女"</span>)).<span class="cm-variable">count</span>())</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">7</span><span class="cm-variable">、12班有多少人参加考试</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">println</span>(<span class="cm-variable">file</span>.<span class="cm-variable">groupBy</span> { <span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> <span class="cm-keyword">val</span> <span class="cm-def">datas</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>); <span class="cm-variable">datas</span>(<span class="cm-number">0</span>) <span class="cm-operator">+</span> <span class="cm-string">"_"</span> <span class="cm-operator">+</span> <span class="cm-variable">datas</span>(<span class="cm-number">1</span>) }.<span class="cm-variable">filter</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">_1</span>.<span class="cm-variable">split</span>(<span class="cm-string">"_"</span>)(<span class="cm-number">0</span>).<span class="cm-variable">equals</span>(<span class="cm-string">"12"</span>)).<span class="cm-variable">count</span>())</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">8</span><span class="cm-variable">、13班有多少人参加考试</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">println</span>(<span class="cm-variable">file</span>.<span class="cm-variable">groupBy</span> { <span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> <span class="cm-keyword">val</span> <span class="cm-def">datas</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>); <span class="cm-variable">datas</span>(<span class="cm-number">0</span>) <span class="cm-operator">+</span> <span class="cm-string">"_"</span> <span class="cm-operator">+</span> <span class="cm-variable">datas</span>(<span class="cm-number">1</span>) }.<span class="cm-variable">filter</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">_1</span>.<span class="cm-variable">split</span>(<span class="cm-string">"_"</span>)(<span class="cm-number">0</span>).<span class="cm-variable">equals</span>(<span class="cm-string">"13"</span>)).<span class="cm-variable">count</span>())</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">9</span><span class="cm-variable">、语文科目的平均成绩是多少</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">println</span>(<span class="cm-variable">file</span>.<span class="cm-variable">filter</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>)(<span class="cm-number">4</span>).<span class="cm-variable">equals</span>(<span class="cm-string">"chinese"</span>)).<span class="cm-variable">map</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>)(<span class="cm-number">5</span>).<span class="cm-variable">toFloat</span>).<span class="cm-variable">mean</span>())</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">10</span><span class="cm-variable">、数学科目的平均成绩是多少</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">println</span>(<span class="cm-variable">file</span>.<span class="cm-variable">filter</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>)(<span class="cm-number">4</span>).<span class="cm-variable">equals</span>(<span class="cm-string">"math"</span>)).<span class="cm-variable">map</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>)(<span class="cm-number">5</span>).<span class="cm-variable">toFloat</span>).<span class="cm-variable">mean</span>())</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">11</span><span class="cm-variable">、英语科目的平均成绩是多少</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">println</span>(<span class="cm-variable">file</span>.<span class="cm-variable">filter</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>)(<span class="cm-number">4</span>).<span class="cm-variable">equals</span>(<span class="cm-string">"english"</span>)).<span class="cm-variable">map</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>)(<span class="cm-number">5</span>).<span class="cm-variable">toFloat</span>).<span class="cm-variable">mean</span>())</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">12</span><span class="cm-variable">、单个人平均成绩是多少</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">println</span>(<span class="cm-variable">file</span>.<span class="cm-variable">map</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">val</span> <span class="cm-def">line</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  (<span class="cm-variable">line</span>(<span class="cm-number">0</span>) <span class="cm-operator">+</span> <span class="cm-string">"_"</span> <span class="cm-operator">+</span> <span class="cm-variable">line</span>(<span class="cm-number">1</span>), <span class="cm-variable">line</span>(<span class="cm-number">5</span>).<span class="cm-variable">toInt</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}).<span class="cm-variable">map</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> (<span class="cm-variable">x</span>.<span class="cm-variable">_1</span>, (<span class="cm-variable">x</span>.<span class="cm-variable">_2</span>, <span class="cm-number">1</span>))).<span class="cm-variable">reduceByKey</span>((<span class="cm-variable">x</span>, <span class="cm-variable">y</span>) <span class="cm-operator">=&gt;</span> (<span class="cm-variable">x</span>.<span class="cm-variable">_1</span> <span class="cm-operator">+</span> <span class="cm-variable">y</span>.<span class="cm-variable">_1</span>, <span class="cm-variable">x</span>.<span class="cm-variable">_2</span> <span class="cm-operator">+</span> <span class="cm-variable">y</span>.<span class="cm-variable">_2</span>)).<span class="cm-variable">map</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> (<span class="cm-variable">x</span>.<span class="cm-variable">_1</span>, <span class="cm-variable">x</span>.<span class="cm-variable">_2</span>.<span class="cm-variable">_1</span> <span class="cm-operator">/</span> <span class="cm-variable">x</span>.<span class="cm-variable">_2</span>.<span class="cm-variable">_2</span>)).<span class="cm-variable">collect</span>().<span class="cm-variable">mkString</span>(<span class="cm-string">","</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">13</span><span class="cm-variable">、12班平均成绩是多少</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">println</span>(<span class="cm-variable">file</span>.<span class="cm-variable">filter</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>)(<span class="cm-number">0</span>).<span class="cm-variable">equals</span>(<span class="cm-string">"12"</span>)).<span class="cm-variable">map</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">line</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>); (<span class="cm-variable">line</span>(<span class="cm-number">0</span>), <span class="cm-variable">line</span>(<span class="cm-number">5</span>).<span class="cm-variable">toInt</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}).<span class="cm-variable">map</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> (<span class="cm-variable">x</span>.<span class="cm-variable">_1</span>, (<span class="cm-variable">x</span>.<span class="cm-variable">_2</span>, <span class="cm-number">1</span>))).<span class="cm-variable">reduceByKey</span>((<span class="cm-variable">x</span>, <span class="cm-variable">y</span>) <span class="cm-operator">=&gt;</span> (<span class="cm-variable">x</span>.<span class="cm-variable">_1</span> <span class="cm-operator">+</span> <span class="cm-variable">y</span>.<span class="cm-variable">_1</span>, <span class="cm-variable">x</span>.<span class="cm-variable">_2</span> <span class="cm-operator">+</span> <span class="cm-variable">y</span>.<span class="cm-variable">_2</span>)).<span class="cm-variable">map</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> (<span class="cm-variable">x</span>.<span class="cm-variable">_1</span>, <span class="cm-variable">x</span>.<span class="cm-variable">_2</span>.<span class="cm-variable">_1</span> <span class="cm-operator">/</span> <span class="cm-variable">x</span>.<span class="cm-variable">_2</span>.<span class="cm-variable">_2</span>)).<span class="cm-variable">map</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">_2</span>).<span class="cm-variable">collect</span>().<span class="cm-variable">mkString</span>(<span class="cm-string">","</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">14</span><span class="cm-variable">、12班男生平均总成绩是多少</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">println</span>(<span class="cm-variable">file</span>.<span class="cm-variable">filter</span> { <span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> <span class="cm-keyword">var</span> <span class="cm-def">datas</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>); <span class="cm-variable">datas</span>(<span class="cm-number">0</span>).<span class="cm-variable">equals</span>(<span class="cm-string">"12"</span>) <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable">datas</span>(<span class="cm-number">3</span>).<span class="cm-variable">equals</span>(<span class="cm-string">"男"</span>) }.<span class="cm-variable">map</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> {<span class="cm-keyword">val</span> <span class="cm-def">line</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>); (<span class="cm-variable">line</span>(<span class="cm-number">0</span>), <span class="cm-variable">line</span>(<span class="cm-number">5</span>).<span class="cm-variable">toInt</span>)})</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">.<span class="cm-variable">map</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> (<span class="cm-variable">x</span>.<span class="cm-variable">_1</span>, (<span class="cm-variable">x</span>.<span class="cm-variable">_2</span>, <span class="cm-number">1</span>))).<span class="cm-variable">reduceByKey</span>((<span class="cm-variable">x</span>, <span class="cm-variable">y</span>) <span class="cm-operator">=&gt;</span> (<span class="cm-variable">x</span>.<span class="cm-variable">_1</span> <span class="cm-operator">+</span> <span class="cm-variable">y</span>.<span class="cm-variable">_1</span>, <span class="cm-variable">x</span>.<span class="cm-variable">_2</span> <span class="cm-operator">+</span> <span class="cm-variable">y</span>.<span class="cm-variable">_2</span>)).<span class="cm-variable">map</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> (<span class="cm-variable">x</span>.<span class="cm-variable">_1</span>, <span class="cm-variable">x</span>.<span class="cm-variable">_2</span>.<span class="cm-variable">_1</span> <span class="cm-operator">/</span> <span class="cm-variable">x</span>.<span class="cm-variable">_2</span>.<span class="cm-variable">_2</span>)).<span class="cm-variable">map</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">_2</span>).<span class="cm-variable">collect</span>().<span class="cm-variable">mkString</span>(<span class="cm-string">","</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">15</span><span class="cm-variable">、12班女生平均总成绩是多少？</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">println</span>(<span class="cm-variable">file</span>.<span class="cm-variable">filter</span> { <span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> <span class="cm-keyword">var</span> <span class="cm-def">datas</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>); <span class="cm-variable">datas</span>(<span class="cm-number">0</span>).<span class="cm-variable">equals</span>(<span class="cm-string">"12"</span>) <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable">datas</span>(<span class="cm-number">3</span>).<span class="cm-variable">equals</span>(<span class="cm-string">"女"</span>) }.<span class="cm-variable">map</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> {<span class="cm-keyword">val</span> <span class="cm-def">line</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>); (<span class="cm-variable">line</span>(<span class="cm-number">0</span>), <span class="cm-variable">line</span>(<span class="cm-number">5</span>).<span class="cm-variable">toInt</span>)})</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">.<span class="cm-variable">map</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> (<span class="cm-variable">x</span>.<span class="cm-variable">_1</span>, (<span class="cm-variable">x</span>.<span class="cm-variable">_2</span>, <span class="cm-number">1</span>))).<span class="cm-variable">reduceByKey</span>((<span class="cm-variable">x</span>, <span class="cm-variable">y</span>) <span class="cm-operator">=&gt;</span> (<span class="cm-variable">x</span>.<span class="cm-variable">_1</span> <span class="cm-operator">+</span> <span class="cm-variable">y</span>.<span class="cm-variable">_1</span>, <span class="cm-variable">x</span>.<span class="cm-variable">_2</span> <span class="cm-operator">+</span> <span class="cm-variable">y</span>.<span class="cm-variable">_2</span>)).<span class="cm-variable">map</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> (<span class="cm-variable">x</span>.<span class="cm-variable">_1</span>, <span class="cm-variable">x</span>.<span class="cm-variable">_2</span>.<span class="cm-variable">_1</span> <span class="cm-operator">/</span> <span class="cm-variable">x</span>.<span class="cm-variable">_2</span>.<span class="cm-variable">_2</span>)).<span class="cm-variable">map</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">_2</span>).<span class="cm-variable">collect</span>().<span class="cm-variable">mkString</span>(<span class="cm-string">","</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">16</span><span class="cm-variable">、13班平均成绩是多少？</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">println</span>(<span class="cm-variable">file</span>.<span class="cm-variable">filter</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>)(<span class="cm-number">0</span>).<span class="cm-variable">equals</span>(<span class="cm-string">"13"</span>)).<span class="cm-variable">map</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> {<span class="cm-keyword">val</span> <span class="cm-def">line</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>); (<span class="cm-variable">line</span>(<span class="cm-number">0</span>), <span class="cm-variable">line</span>(<span class="cm-number">5</span>).<span class="cm-variable">toInt</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}).<span class="cm-variable">map</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> (<span class="cm-variable">x</span>.<span class="cm-variable">_1</span>, (<span class="cm-variable">x</span>.<span class="cm-variable">_2</span>, <span class="cm-number">1</span>))).<span class="cm-variable">reduceByKey</span>((<span class="cm-variable">x</span>, <span class="cm-variable">y</span>) <span class="cm-operator">=&gt;</span> (<span class="cm-variable">x</span>.<span class="cm-variable">_1</span> <span class="cm-operator">+</span> <span class="cm-variable">y</span>.<span class="cm-variable">_1</span>, <span class="cm-variable">x</span>.<span class="cm-variable">_2</span> <span class="cm-operator">+</span> <span class="cm-variable">y</span>.<span class="cm-variable">_2</span>)).<span class="cm-variable">map</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> (<span class="cm-variable">x</span>.<span class="cm-variable">_1</span>, <span class="cm-variable">x</span>.<span class="cm-variable">_2</span>.<span class="cm-variable">_1</span> <span class="cm-operator">/</span> <span class="cm-variable">x</span>.<span class="cm-variable">_2</span>.<span class="cm-variable">_2</span>)).<span class="cm-variable">map</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">_2</span>).<span class="cm-variable">collect</span>().<span class="cm-variable">mkString</span>(<span class="cm-string">","</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">17</span><span class="cm-variable">、13班男生平均总成绩是多少</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">println</span>(<span class="cm-variable">file</span>.<span class="cm-variable">filter</span> { <span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> <span class="cm-keyword">var</span> <span class="cm-def">datas</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>); <span class="cm-variable">datas</span>(<span class="cm-number">0</span>).<span class="cm-variable">equals</span>(<span class="cm-string">"13"</span>) <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable">datas</span>(<span class="cm-number">3</span>).<span class="cm-variable">equals</span>(<span class="cm-string">"男"</span>) }.<span class="cm-variable">map</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> {<span class="cm-keyword">val</span> <span class="cm-def">line</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>); (<span class="cm-variable">line</span>(<span class="cm-number">0</span>), <span class="cm-variable">line</span>(<span class="cm-number">5</span>).<span class="cm-variable">toInt</span>)}).<span class="cm-variable">map</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> (<span class="cm-variable">x</span>.<span class="cm-variable">_1</span>, (<span class="cm-variable">x</span>.<span class="cm-variable">_2</span>, <span class="cm-number">1</span>))).<span class="cm-variable">reduceByKey</span>((<span class="cm-variable">x</span>, <span class="cm-variable">y</span>) <span class="cm-operator">=&gt;</span> (<span class="cm-variable">x</span>.<span class="cm-variable">_1</span> <span class="cm-operator">+</span> <span class="cm-variable">y</span>.<span class="cm-variable">_1</span>, <span class="cm-variable">x</span>.<span class="cm-variable">_2</span> <span class="cm-operator">+</span> <span class="cm-variable">y</span>.<span class="cm-variable">_2</span>)).<span class="cm-variable">map</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> (<span class="cm-variable">x</span>.<span class="cm-variable">_1</span>, <span class="cm-variable">x</span>.<span class="cm-variable">_2</span>.<span class="cm-variable">_1</span> <span class="cm-operator">/</span> <span class="cm-variable">x</span>.<span class="cm-variable">_2</span>.<span class="cm-variable">_2</span>)).<span class="cm-variable">map</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">_2</span>).<span class="cm-variable">collect</span>().<span class="cm-variable">mkString</span>(<span class="cm-string">","</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">18</span><span class="cm-variable">、13班女生平均总成绩是多少</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">println</span>(<span class="cm-variable">file</span>.<span class="cm-variable">filter</span> { <span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> <span class="cm-keyword">var</span> <span class="cm-def">datas</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>); <span class="cm-variable">datas</span>(<span class="cm-number">0</span>).<span class="cm-variable">equals</span>(<span class="cm-string">"13"</span>) <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable">datas</span>(<span class="cm-number">3</span>).<span class="cm-variable">equals</span>(<span class="cm-string">"女"</span>) }.<span class="cm-variable">map</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> {<span class="cm-keyword">val</span> <span class="cm-def">line</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>); (<span class="cm-variable">line</span>(<span class="cm-number">0</span>), <span class="cm-variable">line</span>(<span class="cm-number">5</span>).<span class="cm-variable">toInt</span>)}).<span class="cm-variable">map</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> (<span class="cm-variable">x</span>.<span class="cm-variable">_1</span>, (<span class="cm-variable">x</span>.<span class="cm-variable">_2</span>, <span class="cm-number">1</span>))).<span class="cm-variable">reduceByKey</span>((<span class="cm-variable">x</span>, <span class="cm-variable">y</span>) <span class="cm-operator">=&gt;</span> (<span class="cm-variable">x</span>.<span class="cm-variable">_1</span> <span class="cm-operator">+</span> <span class="cm-variable">y</span>.<span class="cm-variable">_1</span>, <span class="cm-variable">x</span>.<span class="cm-variable">_2</span> <span class="cm-operator">+</span> <span class="cm-variable">y</span>.<span class="cm-variable">_2</span>)).<span class="cm-variable">map</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> (<span class="cm-variable">x</span>.<span class="cm-variable">_1</span>, <span class="cm-variable">x</span>.<span class="cm-variable">_2</span>.<span class="cm-variable">_1</span> <span class="cm-operator">/</span> <span class="cm-variable">x</span>.<span class="cm-variable">_2</span>.<span class="cm-variable">_2</span>)).<span class="cm-variable">map</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">_2</span>).<span class="cm-variable">collect</span>().<span class="cm-variable">mkString</span>(<span class="cm-string">","</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">19</span><span class="cm-variable">、全校语文成绩最高分是多少</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">println</span>(<span class="cm-variable">file</span>.<span class="cm-variable">filter</span> {<span class="cm-keyword">_</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>)(<span class="cm-number">4</span>).<span class="cm-variable">equals</span>(<span class="cm-string">"chinese"</span>)}.<span class="cm-variable">map</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>)(<span class="cm-number">5</span>)).<span class="cm-variable">max</span>())</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">20</span><span class="cm-variable">、12班语文成绩最低分是多少</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">println</span>(<span class="cm-variable">file</span>.<span class="cm-variable">filter</span> { <span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> <span class="cm-keyword">var</span> <span class="cm-def">datas</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>); <span class="cm-variable">datas</span>(<span class="cm-number">4</span>).<span class="cm-variable">equals</span>(<span class="cm-string">"chinese"</span>) <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable">datas</span>(<span class="cm-number">0</span>).<span class="cm-variable">equals</span>(<span class="cm-string">"12"</span>) }.<span class="cm-variable">map</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>)(<span class="cm-number">5</span>)).<span class="cm-variable">min</span>())</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">21</span><span class="cm-variable">、13班数学最高成绩是多少</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">println</span>(<span class="cm-variable">file</span>.<span class="cm-variable">filter</span> { <span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> <span class="cm-keyword">var</span> <span class="cm-def">datas</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>); <span class="cm-variable">datas</span>(<span class="cm-number">4</span>).<span class="cm-variable">equals</span>(<span class="cm-string">"math"</span>) <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable">datas</span>(<span class="cm-number">0</span>).<span class="cm-variable">equals</span>(<span class="cm-string">"13"</span>) }.<span class="cm-variable">map</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>)(<span class="cm-number">5</span>)).<span class="cm-variable">max</span>())</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">22</span><span class="cm-variable">、总成绩大于150分的12班的女生有几个</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">//方式一：无shuffle</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">println</span>(<span class="cm-variable">file</span>.<span class="cm-variable">filter</span> { <span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> <span class="cm-keyword">var</span> <span class="cm-def">datas</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>); <span class="cm-variable">datas</span>(<span class="cm-number">3</span>).<span class="cm-variable">equals</span>(<span class="cm-string">"女"</span>) <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable">datas</span>(<span class="cm-number">0</span>).<span class="cm-variable">equals</span>(<span class="cm-string">"12"</span>) }.<span class="cm-variable">groupBy</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>)(<span class="cm-number">1</span>)).<span class="cm-variable">map</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">case</span> (<span class="cm-variable">name</span>, <span class="cm-variable">list</span>) <span class="cm-operator">=&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable">list</span>.<span class="cm-variable">map</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>)(<span class="cm-number">5</span>).<span class="cm-variable">toFloat</span>).<span class="cm-variable">sum</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}.<span class="cm-variable">filter</span>(<span class="cm-keyword">_</span> <span class="cm-operator">&gt;</span> <span class="cm-number">150</span>).<span class="cm-variable">count</span>())</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">//方式二：有shuffle</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">println</span>(<span class="cm-variable">file</span>.<span class="cm-variable">filter</span> { <span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> <span class="cm-keyword">var</span> <span class="cm-def">datas</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>); <span class="cm-variable">datas</span>(<span class="cm-number">3</span>).<span class="cm-variable">equals</span>(<span class="cm-string">"女"</span>) <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable">datas</span>(<span class="cm-number">0</span>).<span class="cm-variable">equals</span>(<span class="cm-string">"12"</span>) }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">.<span class="cm-variable">map</span> { <span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> <span class="cm-keyword">var</span> <span class="cm-def">datas</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>); (<span class="cm-variable">datas</span>(<span class="cm-number">1</span>), <span class="cm-variable">datas</span>(<span class="cm-number">5</span>).<span class="cm-variable">toInt</span>) }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">.<span class="cm-variable">reduceByKey</span>(<span class="cm-keyword">_</span> <span class="cm-operator">+</span> <span class="cm-keyword">_</span>).<span class="cm-variable">filter</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">_2</span> <span class="cm-operator">&gt;</span> <span class="cm-number">150</span>).<span class="cm-variable">count</span>())</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">23</span><span class="cm-variable">、总成绩大于150分，且数学大于等于70，且年龄大于等于19岁的学生的平均成绩是多少</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">data1</span> <span class="cm-operator">=</span> <span class="cm-variable">file</span>.<span class="cm-variable">map</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> {<span class="cm-keyword">val</span> <span class="cm-def">line</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>); (<span class="cm-variable">line</span>(<span class="cm-number">0</span>) <span class="cm-operator">+</span> <span class="cm-string">","</span> <span class="cm-operator">+</span> <span class="cm-variable">line</span>(<span class="cm-number">1</span>) <span class="cm-operator">+</span> <span class="cm-string">","</span> <span class="cm-operator">+</span> <span class="cm-variable">line</span>(<span class="cm-number">3</span>), <span class="cm-variable">line</span>(<span class="cm-number">5</span>).<span class="cm-variable">toInt</span>)})</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">data2</span> <span class="cm-operator">=</span> <span class="cm-variable">file</span>.<span class="cm-variable">map</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> {<span class="cm-keyword">val</span> <span class="cm-def">line</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>); (<span class="cm-variable">line</span>(<span class="cm-number">0</span>) <span class="cm-operator">+</span> <span class="cm-string">","</span> <span class="cm-operator">+</span> <span class="cm-variable">line</span>(<span class="cm-number">1</span>) <span class="cm-operator">+</span> <span class="cm-string">","</span> <span class="cm-operator">+</span> <span class="cm-variable">line</span>(<span class="cm-number">3</span>) <span class="cm-operator">+</span> <span class="cm-string">","</span> <span class="cm-operator">+</span> <span class="cm-variable">line</span>(<span class="cm-number">4</span>), <span class="cm-variable">line</span>(<span class="cm-number">5</span>).<span class="cm-variable">toInt</span>)})</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">//过滤出总分大于150的,并求出平均成绩</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">com1</span>: <span class="cm-variable">RDD</span>[(<span class="cm-variable-3">String</span>, <span class="cm-variable-3">Int</span>)] <span class="cm-operator">=</span> <span class="cm-variable">data1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">.<span class="cm-variable">map</span>(<span class="cm-variable">a</span> <span class="cm-operator">=&gt;</span> (<span class="cm-variable">a</span>.<span class="cm-variable">_1</span>, (<span class="cm-variable">a</span>.<span class="cm-variable">_2</span>, <span class="cm-number">1</span>)))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">.<span class="cm-variable">reduceByKey</span>((<span class="cm-variable">a</span>, <span class="cm-variable">b</span>) <span class="cm-operator">=&gt;</span> (<span class="cm-variable">a</span>.<span class="cm-variable">_1</span> <span class="cm-operator">+</span> <span class="cm-variable">b</span>.<span class="cm-variable">_1</span>, <span class="cm-variable">a</span>.<span class="cm-variable">_2</span> <span class="cm-operator">+</span> <span class="cm-variable">b</span>.<span class="cm-variable">_2</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">.<span class="cm-variable">filter</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> (<span class="cm-variable">x</span>.<span class="cm-variable">_2</span>.<span class="cm-variable">_1</span> <span class="cm-operator">&gt;</span> <span class="cm-number">150</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">.<span class="cm-variable">map</span>(<span class="cm-variable">t</span> <span class="cm-operator">=&gt;</span> (<span class="cm-variable">t</span>.<span class="cm-variable">_1</span>, <span class="cm-variable">t</span>.<span class="cm-variable">_2</span>.<span class="cm-variable">_1</span> <span class="cm-operator">/</span> <span class="cm-variable">t</span>.<span class="cm-variable">_2</span>.<span class="cm-variable">_2</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">//过滤出 数学大于等于70，且年龄大于等于19岁的学生</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">com2</span>: <span class="cm-variable">RDD</span>[(<span class="cm-variable-3">String</span>, <span class="cm-variable-3">Int</span>)] <span class="cm-operator">=</span> <span class="cm-variable">data2</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">.<span class="cm-variable">filter</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> {<span class="cm-keyword">val</span> <span class="cm-def">datas</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">_1</span>.<span class="cm-variable">split</span>(<span class="cm-string">","</span>); <span class="cm-variable">datas</span>(<span class="cm-number">3</span>).<span class="cm-variable">equals</span>(<span class="cm-string">"math"</span>) <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable">x</span>.<span class="cm-variable">_2</span> <span class="cm-operator">&gt;</span> <span class="cm-number">70</span>})</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">.<span class="cm-variable">map</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> {<span class="cm-keyword">val</span> <span class="cm-def">datas</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">_1</span>.<span class="cm-variable">split</span>(<span class="cm-string">","</span>); (<span class="cm-variable">datas</span>(<span class="cm-number">0</span>) <span class="cm-operator">+</span> <span class="cm-string">","</span> <span class="cm-operator">+</span> <span class="cm-variable">datas</span>(<span class="cm-number">1</span>) <span class="cm-operator">+</span> <span class="cm-string">","</span> <span class="cm-operator">+</span> <span class="cm-variable">datas</span>(<span class="cm-number">2</span>), <span class="cm-variable">x</span>.<span class="cm-variable">_2</span>.<span class="cm-variable">toInt</span>)})</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">println</span>(<span class="cm-variable">com1</span>.<span class="cm-variable">join</span>(<span class="cm-variable">com2</span>).<span class="cm-variable">map</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> (<span class="cm-variable">x</span>.<span class="cm-variable">_1</span>, <span class="cm-variable">x</span>.<span class="cm-variable">_2</span>.<span class="cm-variable">_1</span>)).<span class="cm-variable">collect</span>().<span class="cm-variable">mkString</span>(<span class="cm-string">","</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">sc</span>.<span class="cm-variable">stop</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 3007px;"></div><div class="CodeMirror-gutters" style="display: none; height: 3007px;"></div></div></div></pre><h1 id='spark基础练习题二）'><span>Spark基础练习题（二）</span></h1><h2 id='题目-2'><span>题目</span></h2><p><span>1、创建一个1-10数组的RDD，将所有元素*2形成新的RDD</span></p><p><span>2、创建一个10-20数组的RDD，使用mapPartitions将所有元素*2形成新的RDD</span></p><p><span>3、创建一个元素为 1-5 的RDD，运用 flatMap创建一个新的 RDD，新的 RDD 为原 RDD 每个元素的 平方和三次方 来组成 1,1,4,8,9,27..</span></p><p><span>4、创建一个 4 个分区的 RDD数据为Array(10,20,30,40,50,60)，使用glom将每个分区的数据放到一个数组</span></p><p><span>5、创建一个 RDD数据为Array(1, 3, 4, 20, 4, 5, 8)，按照元素的奇偶性进行分组</span></p><p><span>6、创建一个 RDD（由字符串组成）Array(&quot;xiaoli&quot;, &quot;laoli&quot;, &quot;laowang&quot;, &quot;xiaocang&quot;, &quot;xiaojing&quot;, &quot;xiaokong&quot;)，过滤出一个新 RDD（包含“xiao”子串）</span></p><p><span>7、创建一个 RDD数据为1 to 10，请使用sample不放回抽样</span></p><p><span>8、创建一个 RDD数据为1 to 10，请使用sample放回抽样</span></p><p><span>9、创建一个 RDD数据为Array(10,10,2,5,3,5,3,6,9,1),对 RDD 中元素执行去重操作</span></p><p><span>10、创建一个分区数为5的 RDD，数据为0 to 100，之后使用coalesce再重新减少分区的数量至 2</span></p><p><span>11、创建一个分区数为5的 RDD，数据为0 to 100，之后使用repartition再重新减少分区的数量至 3</span></p><p><span>12、创建一个 RDD数据为1,3,4,10,4,6,9,20,30,16,请给RDD进行分别进行升序和降序排列</span></p><p><span>13、创建两个RDD，分别为rdd1和rdd2数据分别为1 to 6和4 to 10，求并集</span></p><p><span>14、创建两个RDD，分别为rdd1和rdd2数据分别为1 to 6和4 to 10，计算差集，两个都算</span></p><p><span>15、创建两个RDD，分别为rdd1和rdd2数据分别为1 to 6和4 to 10，计算交集</span></p><p><span>16、创建两个RDD，分别为rdd1和rdd2数据分别为1 to 6和4 to 10，计算 2 个 RDD 的笛卡尔积</span></p><p><span>17、创建两个RDD，分别为rdd1和rdd2数据分别为1 to 5和11 to 15，对两个RDD拉链操作</span></p><p><span>18、创建一个RDD数据为List((&quot;female&quot;,1),(&quot;male&quot;,5),(&quot;female&quot;,5),(&quot;male&quot;,2))，请计算出female和male的总数分别为多少</span></p><p><span>19、创建一个有两个分区的 RDD数据为List((&quot;a&quot;,3),(&quot;a&quot;,2),(&quot;c&quot;,4),(&quot;b&quot;,3),(&quot;c&quot;,6),(&quot;c&quot;,8))，取出每个分区相同key对应值的最大值，然后相加</span></p><p><span>20、 创建一个有两个分区的 pairRDD数据为Array((&quot;a&quot;, 88), (&quot;b&quot;, 95), (&quot;a&quot;, 91), (&quot;b&quot;, 93), (&quot;a&quot;, 95), (&quot;b&quot;, 98))，根据 key 计算每种 key 的value的平均值</span></p><p><span>21、统计出每一个省份广告被点击次数的 TOP3，数据在access.log文件中</span>
<span>数据结构：时间戳，省份，城市，用户，广告 字段使用空格分割。</span>
<span>样本如下：</span>
<span>1516609143867 6 7 64 16</span>
<span>1516609143869 9 4 75 18</span>
<span>1516609143869 1 7 87 12</span></p><p><span>22、读取本地文件words.txt,统计出每个单词的个数，保存数据到 hdfs 上</span></p><p><span>23、读取 people.json 数据的文件, 每行是一个 json 对象，进行解析输出</span></p><p><span>24、保存一个 SequenceFile 文件，使用spark创建一个RDD数据为Array((&quot;a&quot;, 1),(&quot;b&quot;, 2),(&quot;c&quot;, 3))，保存为SequenceFile格式的文件到hdfs上</span></p><p><span>25、读取24题的SequenceFile 文件并输出</span></p><p><span>26、读写 objectFile 文件，把 RDD 保存为objectFile，RDD数据为Array((&quot;a&quot;, 1),(&quot;b&quot;, 2),(&quot;c&quot;, 3))，并进行读取出来</span></p><p><span>27、使用内置累加器计算Accumulator.txt文件中空行的数量</span></p><p><span>28、使用Spark广播变量</span>
<span>用户表：</span>
<span>id name age gender(0|1)</span>
<span>001,刘向前,18,0</span>
<span>002,冯  剑,28,1</span>
<span>003,李志杰,38,0</span>
<span>004,郭  鹏,48,2</span>
<span>要求，输出用户信息，gender必须为男或者女，不能为0,1</span>
<span>使用广播变量把Map(&quot;0&quot; -&gt; &quot;女&quot;, &quot;1&quot; -&gt; &quot;男&quot;)设置为广播变量，最终输出格式为</span>
<span>001,刘向前,18,女</span>
<span>003,李志杰,38,女</span>
<span>002,冯  剑,28,男</span>
<span>004,郭  鹏,48,男</span></p><p><span>29、mysql创建一个数据库bigdata0407，在此数据库中创建一张表</span>
<span>CREATE TABLE </span><code>user</code><span> (</span>
<span>  </span><code>id</code><span> int(11) NOT NULL AUTO_INCREMENT,</span>
<span>  </span><code>username</code><span> varchar(32) NOT NULL COMMENT &#39;用户名称&#39;,</span>
<span>  </span><code>birthday</code><span> date DEFAULT NULL COMMENT &#39;生日&#39;,</span>
<span>  </span><code>sex</code><span> char(1) DEFAULT NULL COMMENT &#39;性别&#39;,</span>
<span>  </span><code>address</code><span> varchar(256) DEFAULT NULL COMMENT &#39;地址&#39;,</span>
<span>  PRIMARY KEY (</span><code>id</code><span>)</span>
<span>) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;</span>
<span>数据依次是：姓名 生日 性别 省份</span>
<span>请使用spark将以上数据写入mysql中，并读取出来</span></p><p><span>30、在hbase中创建一个表student，有一个 message列族</span>
<span>create &#39;student&#39;, &#39;message&#39;</span>
<span>scan &#39;student&#39;, {COLUMNS =&gt; &#39;message&#39;}</span>
<span>给出以下数据，请使用spark将数据写入到hbase中的student表中,并进行查询出来</span>
<span>数据如下：</span>
<span>依次是：姓名 班级 性别 省份，对应表中的字段依次是：name,class,sex,province</span></p><h2 id='数据-2'><span>数据</span></h2><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="ABAP"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="abap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.38889px; left: 11.9965px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-error">因为有几个文件数据较多，所以不方便在这里贴出来，所以把它上传到了百度云上，对应的资源在这里</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-error">链接:</span> <span class="cm-error">https://pan.baidu.com/s/1XMdS2BHOdCHaaC8y-OiEOw</span> <span class="cm-error">提取码:</span> <span class="cm-number">1234</span> <span class="cm-error">复制这段内容后打开百度网盘手机App，操作更方便哦</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-error">如果链接失效请私信我！</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 137px;"></div><div class="CodeMirror-gutters" style="display: none; height: 137px;"></div></div></div></pre><h2 id='答案-2'><span>答案</span></h2><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="scala" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="scala"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.38892px; left: 11.9965px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">sc</span>: <span class="cm-variable">SparkContext</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">SparkContext</span>(<span class="cm-keyword">new</span> <span class="cm-variable">SparkConf</span>().<span class="cm-variable">setMaster</span>(<span class="cm-string">"local"</span>).<span class="cm-variable">setAppName</span>(<span class="cm-string">"HomeWork20200407"</span>))</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// 1、创建一个1-10数组的RDD，将所有元素*2形成新的RDD</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data1</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">makeRDD</span>(<span class="cm-number">1</span> <span class="cm-variable">to</span> <span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data1Result</span> <span class="cm-operator">=</span> <span class="cm-variable">data1</span>.<span class="cm-variable">map</span>(<span class="cm-keyword">_</span> <span class="cm-operator">*</span> <span class="cm-number">2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">// 2、创建一个10-20数组的RDD，使用mapPartitions将所有元素*2形成新的RDD</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data2</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">makeRDD</span>(<span class="cm-number">10</span> <span class="cm-variable">to</span> <span class="cm-number">20</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data2Result</span> <span class="cm-operator">=</span> <span class="cm-variable">data2</span>.<span class="cm-variable">mapPartitions</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">map</span>(<span class="cm-keyword">_</span> <span class="cm-operator">*</span> <span class="cm-number">2</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">// 3、创建一个元素为 1-5 的RDD，运用 flatMap创建一个新的 RDD，新的 RDD 为原 RDD 每个元素的 平方和三次方 来组成 1,1,4,8,9,27..</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data3</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">makeRDD</span>(<span class="cm-number">1</span> <span class="cm-variable">to</span> <span class="cm-number">5</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data3Result</span> <span class="cm-operator">=</span> <span class="cm-variable">data3</span>.<span class="cm-variable">flatMap</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> <span class="cm-variable-3">Array</span>(<span class="cm-variable">math</span>.<span class="cm-variable">pow</span>(<span class="cm-variable">x</span>, <span class="cm-number">2</span>), <span class="cm-variable">math</span>.<span class="cm-variable">pow</span>(<span class="cm-variable">x</span>, <span class="cm-number">3</span>)))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">// 4、创建一个 4 个分区的 RDD数据为Array(10,20,30,40,50,60)，使用glom将每个分区的数据放到一个数组</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data4</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">makeRDD</span>(<span class="cm-variable-3">Array</span>(<span class="cm-number">10</span>, <span class="cm-number">20</span>, <span class="cm-number">30</span>, <span class="cm-number">40</span>, <span class="cm-number">50</span>, <span class="cm-number">60</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data4Result</span> <span class="cm-operator">=</span> <span class="cm-variable">data4</span>.<span class="cm-variable">glom</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">// 5、创建一个 RDD数据为Array(1, 3, 4, 20, 4, 5, 8)，按照元素的奇偶性进行分组</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data5</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">makeRDD</span>(<span class="cm-variable-3">Array</span>(<span class="cm-number">1</span>, <span class="cm-number">3</span>, <span class="cm-number">4</span>, <span class="cm-number">20</span>, <span class="cm-number">4</span>, <span class="cm-number">5</span>, <span class="cm-number">8</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data5Result</span> <span class="cm-operator">=</span> <span class="cm-variable">data5</span>.<span class="cm-variable">groupBy</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> <span class="cm-keyword">if</span> (<span class="cm-variable">x</span> <span class="cm-operator">%</span> <span class="cm-number">2</span> <span class="cm-operator">==</span> <span class="cm-number">0</span>) <span class="cm-string">"偶数"</span> <span class="cm-keyword">else</span> <span class="cm-string">"奇数"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">// 6、创建一个 RDD（由字符串组成）Array("xiaoli", "laoli", "laowang", "xiaocang", "xiaojing", "xiaokong")，过滤出一个新 RDD（包含“xiao”子串）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data6</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">makeRDD</span>(<span class="cm-variable-3">Array</span>(<span class="cm-string">"xiaoli"</span>, <span class="cm-string">"laoli"</span>, <span class="cm-string">"laowang"</span>, <span class="cm-string">"xiaocang"</span>, <span class="cm-string">"xiaojing"</span>, <span class="cm-string">"xiaokong"</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data6Result</span> <span class="cm-operator">=</span> <span class="cm-variable">data6</span>.<span class="cm-variable">filter</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">contains</span>(<span class="cm-string">"xiao"</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">// 7、创建一个 RDD数据为1 to 10，请使用sample不放回抽样</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data7</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">makeRDD</span>(<span class="cm-number">1</span> <span class="cm-variable">to</span> <span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data7Result</span> <span class="cm-operator">=</span> <span class="cm-variable">data7</span>.<span class="cm-variable">sample</span>(<span class="cm-atom">false</span>, <span class="cm-number">0.5</span>, <span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">// 8、创建一个 RDD数据为1 to 10，请使用sample放回抽样</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data8</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">makeRDD</span>(<span class="cm-number">1</span> <span class="cm-variable">to</span> <span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data8Result</span> <span class="cm-operator">=</span> <span class="cm-variable">data8</span>.<span class="cm-variable">sample</span>(<span class="cm-atom">true</span>, <span class="cm-number">0.5</span>, <span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">// 9、创建一个 RDD数据为Array(10,10,2,5,3,5,3,6,9,1),对 RDD 中元素执行去重操作</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data9</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">makeRDD</span>(<span class="cm-variable-3">Array</span>(<span class="cm-number">10</span>, <span class="cm-number">10</span>, <span class="cm-number">2</span>, <span class="cm-number">5</span>, <span class="cm-number">3</span>, <span class="cm-number">5</span>, <span class="cm-number">3</span>, <span class="cm-number">6</span>, <span class="cm-number">9</span>, <span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data9Result</span> <span class="cm-operator">=</span> <span class="cm-variable">data9</span>.<span class="cm-variable">distinct</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">// 10、创建一个分区数为5的 RDD，数据为0 to 100，之后使用coalesce再重新减少分区的数量至 2</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data10</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">makeRDD</span>(<span class="cm-number">0</span> <span class="cm-variable">to</span> <span class="cm-number">100</span>, <span class="cm-number">5</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data10Result</span> <span class="cm-operator">=</span> <span class="cm-variable">data10</span>.<span class="cm-variable">coalesce</span>(<span class="cm-number">2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">// 11、创建一个分区数为5的 RDD，数据为0 to 100，之后使用repartition再重新减少分区的数量至 3</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data11</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">makeRDD</span>(<span class="cm-number">0</span> <span class="cm-variable">to</span> <span class="cm-number">100</span>, <span class="cm-number">5</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data11Result</span> <span class="cm-operator">=</span> <span class="cm-variable">data11</span>.<span class="cm-variable">repartition</span>(<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">// 12、创建一个 RDD数据为1,3,4,10,4,6,9,20,30,16,请给RDD进行分别进行升序和降序排列</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data12</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">makeRDD</span>(<span class="cm-variable-3">Array</span>(<span class="cm-number">1</span>, <span class="cm-number">3</span>, <span class="cm-number">4</span>, <span class="cm-number">10</span>, <span class="cm-number">4</span>, <span class="cm-number">6</span>, <span class="cm-number">9</span>, <span class="cm-number">20</span>, <span class="cm-number">30</span>, <span class="cm-number">16</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data12Result1</span> <span class="cm-operator">=</span> <span class="cm-variable">data12</span>.<span class="cm-variable">sortBy</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> <span class="cm-variable">x</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data12Result2</span> <span class="cm-operator">=</span> <span class="cm-variable">data12</span>.<span class="cm-variable">sortBy</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> <span class="cm-variable">x</span>, <span class="cm-atom">false</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">// 13、创建两个RDD，分别为rdd1和rdd2数据分别为1 to 6和4 to 10，求并集</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data13_1</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">makeRDD</span>(<span class="cm-number">1</span> <span class="cm-variable">to</span> <span class="cm-number">6</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data13_2</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">makeRDD</span>(<span class="cm-number">4</span> <span class="cm-variable">to</span> <span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data13Result</span> <span class="cm-operator">=</span> <span class="cm-variable">data13_1</span>.<span class="cm-variable">union</span>(<span class="cm-variable">data13_2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">// 14、创建两个RDD，分别为rdd1和rdd2数据分别为1 to 6和4 to 10，计算差集，两个都算</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data14_1</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">makeRDD</span>(<span class="cm-number">1</span> <span class="cm-variable">to</span> <span class="cm-number">6</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data14_2</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">makeRDD</span>(<span class="cm-number">4</span> <span class="cm-variable">to</span> <span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data14Result_1</span> <span class="cm-operator">=</span> <span class="cm-variable">data14_1</span>.<span class="cm-variable">subtract</span>(<span class="cm-variable">data14_2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data14Result_2</span> <span class="cm-operator">=</span> <span class="cm-variable">data14_2</span>.<span class="cm-variable">subtract</span>(<span class="cm-variable">data14_1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">// 15、创建两个RDD，分别为rdd1和rdd2数据分别为1 to 6和4 to 10，计算交集</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data15_1</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">makeRDD</span>(<span class="cm-number">1</span> <span class="cm-variable">to</span> <span class="cm-number">6</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data15_2</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">makeRDD</span>(<span class="cm-number">4</span> <span class="cm-variable">to</span> <span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data15Result_1</span> <span class="cm-operator">=</span> <span class="cm-variable">data15_1</span>.<span class="cm-variable">intersection</span>(<span class="cm-variable">data15_2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">// 16、创建两个RDD，分别为rdd1和rdd2数据分别为1 to 6和4 to 10，计算 2 个 RDD 的笛卡尔积</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data16_1</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">makeRDD</span>(<span class="cm-number">1</span> <span class="cm-variable">to</span> <span class="cm-number">6</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data16_2</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">makeRDD</span>(<span class="cm-number">4</span> <span class="cm-variable">to</span> <span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data16Result</span> <span class="cm-operator">=</span> <span class="cm-variable">data16_1</span>.<span class="cm-variable">cartesian</span>(<span class="cm-variable">data16_2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">// 17、创建两个RDD，分别为rdd1和rdd2数据分别为1 to 5和11 to 15，对两个RDD拉链操作</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data17_1</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">makeRDD</span>(<span class="cm-number">1</span> <span class="cm-variable">to</span> <span class="cm-number">5</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data17_2</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">makeRDD</span>(<span class="cm-number">11</span> <span class="cm-variable">to</span> <span class="cm-number">15</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data17Result</span> <span class="cm-operator">=</span> <span class="cm-variable">data17_1</span>.<span class="cm-variable">zip</span>(<span class="cm-variable">data17_2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">// 18、创建一个RDD数据为List(("female",1),("male",5),("female",5),("male",2))，请计算出female和male的总数分别为多少</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data18</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">makeRDD</span>(<span class="cm-variable-3">List</span>((<span class="cm-string">"female"</span>, <span class="cm-number">1</span>), (<span class="cm-string">"male"</span>, <span class="cm-number">5</span>), (<span class="cm-string">"female"</span>, <span class="cm-number">5</span>), (<span class="cm-string">"male"</span>, <span class="cm-number">2</span>)))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data18Result</span> <span class="cm-operator">=</span> <span class="cm-variable">data18</span>.<span class="cm-variable">reduceByKey</span>(<span class="cm-keyword">_</span> <span class="cm-operator">+</span> <span class="cm-keyword">_</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">// 19、创建一个有两个分区的 RDD数据为List(("a",3),("a",2),("c",4),("b",3),("c",6),("c",8))，取出每个分区相同key对应值的最大值，然后相加</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">/**</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* (a,3),(a,2),(c,4)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* (b,3),(c,6),(c,8)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data19</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">makeRDD</span>(<span class="cm-variable-3">List</span>((<span class="cm-string">"a"</span>, <span class="cm-number">3</span>), (<span class="cm-string">"a"</span>, <span class="cm-number">2</span>), (<span class="cm-string">"c"</span>, <span class="cm-number">4</span>), (<span class="cm-string">"b"</span>, <span class="cm-number">3</span>), (<span class="cm-string">"c"</span>, <span class="cm-number">6</span>), (<span class="cm-string">"c"</span>, <span class="cm-number">8</span>)), <span class="cm-number">2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-variable">data19</span>.<span class="cm-variable">glom</span>().<span class="cm-variable">collect</span>().<span class="cm-variable">foreach</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> <span class="cm-keyword">println</span>(<span class="cm-variable">x</span>.<span class="cm-variable">mkString</span>(<span class="cm-string">","</span>)))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data19Result</span> <span class="cm-operator">=</span> <span class="cm-variable">data19</span>.<span class="cm-variable">aggregateByKey</span>(<span class="cm-number">0</span>)(<span class="cm-variable">math</span>.<span class="cm-variable">max</span>(<span class="cm-keyword">_</span>, <span class="cm-keyword">_</span>), <span class="cm-keyword">_</span> <span class="cm-operator">+</span> <span class="cm-keyword">_</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">// 20、创建一个有两个分区的 pairRDD数据为Array(("a", 88), ("b", 95), ("a", 91), ("b", 93), ("a", 95), ("b", 98))，根据 key 计算每种 key 的value的平均值</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data20</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">makeRDD</span>(<span class="cm-variable-3">Array</span>((<span class="cm-string">"a"</span>, <span class="cm-number">88</span>), (<span class="cm-string">"b"</span>, <span class="cm-number">95</span>), (<span class="cm-string">"a"</span>, <span class="cm-number">91</span>), (<span class="cm-string">"b"</span>, <span class="cm-number">93</span>), (<span class="cm-string">"a"</span>, <span class="cm-number">95</span>), (<span class="cm-string">"b"</span>, <span class="cm-number">98</span>)))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data20Result</span> <span class="cm-operator">=</span> <span class="cm-variable">data20</span>.<span class="cm-variable">groupByKey</span>().<span class="cm-variable">map</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> <span class="cm-variable">x</span>.<span class="cm-variable">_1</span> <span class="cm-operator">-&gt;</span> <span class="cm-variable">x</span>.<span class="cm-variable">_2</span>.<span class="cm-variable">sum</span> <span class="cm-operator">/</span> <span class="cm-variable">x</span>.<span class="cm-variable">_2</span>.<span class="cm-variable">size</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">//或val data20Result = data20.map(x =&gt; (x._1, (x._2, 1))).reduceByKey((x, y) =&gt; (x._1 + y._1, x._2 + y._2)).map(x =&gt; (x._1, x._2._1 / x._2._2))</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">// 21、统计出每一个省份广告被点击次数的 TOP3，数据在access.log文件中</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">// 数据结构：时间戳，省份，城市，用户，广告 字段使用空格分割。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">file1</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">textFile</span>(<span class="cm-string">"input20200407/access.log"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-variable">file1</span>.<span class="cm-variable">map</span> { <span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> <span class="cm-keyword">var</span> <span class="cm-def">datas</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>); (<span class="cm-variable">datas</span>(<span class="cm-number">1</span>), (<span class="cm-variable">datas</span>(<span class="cm-number">4</span>), <span class="cm-number">1</span>)) }.<span class="cm-variable">groupByKey</span>().<span class="cm-variable">map</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-keyword">case</span> (<span class="cm-variable">province</span>, <span class="cm-variable">list</span>) <span class="cm-operator">=&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-keyword">val</span> <span class="cm-def">tuples</span> <span class="cm-operator">=</span> <span class="cm-variable">list</span>.<span class="cm-variable">groupBy</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">_1</span>).<span class="cm-variable">map</span>(<span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> (<span class="cm-variable">x</span>.<span class="cm-variable">_1</span>, <span class="cm-variable">x</span>.<span class="cm-variable">_2</span>.<span class="cm-variable">size</span>)).<span class="cm-variable">toList</span>.<span class="cm-variable">sortWith</span>((<span class="cm-variable">x</span>, <span class="cm-variable">y</span>) <span class="cm-operator">=&gt;</span> <span class="cm-variable">x</span>.<span class="cm-variable">_2</span> <span class="cm-operator">&gt;</span> <span class="cm-variable">y</span>.<span class="cm-variable">_2</span>).<span class="cm-variable">take</span>(<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; (<span class="cm-variable">province</span>, <span class="cm-variable">tuples</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> }.<span class="cm-variable">collect</span>().<span class="cm-variable">sortBy</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">_1</span>).<span class="cm-variable">foreach</span>(<span class="cm-keyword">println</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">// 22、读取本地文件words.txt,统计出每个单词的个数，保存数据到 hdfs 上</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">file2</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">textFile</span>(<span class="cm-string">"file:///C:/Develop/HomeWork/input20200407/words.txt"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-variable">file2</span>.<span class="cm-variable">flatMap</span>(<span class="cm-keyword">_</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>)).<span class="cm-variable">map</span>((<span class="cm-keyword">_</span>, <span class="cm-number">1</span>)).<span class="cm-variable">reduceByKey</span>(<span class="cm-keyword">_</span> <span class="cm-operator">+</span> <span class="cm-keyword">_</span>).<span class="cm-variable">saveAsTextFile</span>(<span class="cm-string">"hdfs://mycluster:8020/20200407_wordsOutput"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">// 23、读取 people.json 数据的文件, 每行是一个 json 对象，进行解析输出</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">import</span> <span class="cm-variable">scala</span>.<span class="cm-variable">util</span>.<span class="cm-variable">parsing</span>.<span class="cm-variable">json</span>.<span class="cm-variable">JSON</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">file3</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">textFile</span>(<span class="cm-string">"input20200407/people.json"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">result</span>: <span class="cm-variable">RDD</span>[<span class="cm-variable-3">Option</span>[<span class="cm-variable">Any</span>]] <span class="cm-operator">=</span> <span class="cm-variable">file3</span>.<span class="cm-variable">map</span>(<span class="cm-variable">JSON</span>.<span class="cm-variable">parseFull</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">// 24、保存一个 SequenceFile 文件，使用spark创建一个RDD数据为Array(("a", 1),("b", 2),("c", 3))，保存为SequenceFile格式的文件到hdfs上</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data24</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">makeRDD</span>(<span class="cm-variable-3">Array</span>((<span class="cm-string">"a"</span>, <span class="cm-number">1</span>), (<span class="cm-string">"b"</span>, <span class="cm-number">2</span>), (<span class="cm-string">"c"</span>, <span class="cm-number">3</span>)))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-variable">data24</span>.<span class="cm-variable">saveAsSequenceFile</span>(<span class="cm-string">"hdfs://mycluster:8020/20200407_SequenceFile"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">// 25、读取24题的SequenceFile 文件并输出</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data25</span>: <span class="cm-variable">RDD</span>[(<span class="cm-variable-3">String</span>,<span class="cm-variable-3">Int</span>)] <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">sequenceFile</span>[<span class="cm-variable-3">String</span>,<span class="cm-variable-3">Int</span>](<span class="cm-string">"hdfs://mycluster:8020/20200407_SequenceFile/part-00000"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">// 26、读写 objectFile 文件，把 RDD 保存为objectFile，RDD数据为Array(("a", 1),("b", 2),("c", 3))，并进行读取出来</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data26_1</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">makeRDD</span>(<span class="cm-variable-3">Array</span>((<span class="cm-string">"a"</span>, <span class="cm-number">1</span>), (<span class="cm-string">"b"</span>, <span class="cm-number">2</span>), (<span class="cm-string">"c"</span>, <span class="cm-number">3</span>)))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-variable">data26_1</span>.<span class="cm-variable">saveAsObjectFile</span>(<span class="cm-string">"output20200407/20200407_objectFile"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data26_2</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">objectFile</span>(<span class="cm-string">"output20200407/20200407_objectFile"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">// 27、使用内置累加器计算Accumulator.txt文件中空行的数量</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data27</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">textFile</span>(<span class="cm-string">"input20200407/Accumulator.txt"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">var</span> <span class="cm-def">count</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">longAccumulator</span>(<span class="cm-string">"count"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-variable">data27</span>.<span class="cm-variable">foreach</span> { <span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> <span class="cm-keyword">if</span> (<span class="cm-variable">x</span> <span class="cm-operator">==</span> <span class="cm-string">""</span>) <span class="cm-variable">count</span>.<span class="cm-variable">add</span>(<span class="cm-number">1</span>) }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">println</span>(<span class="cm-variable">count</span>.<span class="cm-variable">value</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">/**</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* 28、使用Spark广播变量</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* 用户表：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* id name age gender(0|1)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* 001,刘向前,18,0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* 002,冯  剑,28,1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* 003,李志杰,38,0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* 004,郭  鹏,48,1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* 要求，输出用户信息，gender必须为男或者女，不能为0,1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* 使用广播变量把Map("0" -&gt; "女", "1" -&gt; "男")设置为广播变量，最终输出格式为</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* 001,刘向前,18,女</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* 003,李志杰,38,女</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* 002,冯  剑,28,男</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* 004,郭  鹏,48,男</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data28</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">textFile</span>(<span class="cm-string">"input20200407/user.txt"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">sex</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">broadcast</span>(<span class="cm-variable-3">Map</span>(<span class="cm-string">"0"</span> <span class="cm-operator">-&gt;</span> <span class="cm-string">"女"</span>, <span class="cm-string">"1"</span> <span class="cm-operator">-&gt;</span> <span class="cm-string">"男"</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-variable">data28</span>.<span class="cm-variable">foreach</span> { <span class="cm-variable">x</span> <span class="cm-operator">=&gt;</span> <span class="cm-keyword">var</span> <span class="cm-def">datas</span> <span class="cm-operator">=</span> <span class="cm-variable">x</span>.<span class="cm-variable">split</span>(<span class="cm-string">","</span>); <span class="cm-keyword">println</span>(<span class="cm-variable">datas</span>(<span class="cm-number">0</span>) <span class="cm-operator">+</span> <span class="cm-string">","</span> <span class="cm-operator">+</span> <span class="cm-variable">datas</span>(<span class="cm-number">1</span>) <span class="cm-operator">+</span> <span class="cm-string">","</span> <span class="cm-operator">+</span> <span class="cm-variable">datas</span>(<span class="cm-number">2</span>) <span class="cm-operator">+</span> <span class="cm-string">","</span> <span class="cm-operator">+</span> <span class="cm-variable">sex</span>.<span class="cm-variable">value</span>(<span class="cm-variable">datas</span>(<span class="cm-number">3</span>))) }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">/**</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* 29、mysql创建一个数据库bigdata0407，在此数据库中创建一张表</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* CREATE TABLE `user` (</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* `id` int(11) NOT NULL AUTO_INCREMENT,</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* `username` varchar(32) NOT NULL COMMENT '用户名称',</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* `birthday` date DEFAULT NULL COMMENT '生日',</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* `sex` char(1) DEFAULT NULL COMMENT '性别',</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* `address` varchar(256) DEFAULT NULL COMMENT '地址',</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* PRIMARY KEY (`id`)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* ) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* 数据如下：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* 依次是：姓名 生日 性别 省份</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* 安荷 1998/2/7 女 江苏省</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* 白秋 2000/3/7 女 天津市</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* 雪莲 1998/6/7 女 湖北省</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* 宾白 1999/7/3 男 河北省</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* 宾实 2000/8/7 男 河北省</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* 斌斌 1998/3/7 男 江苏省</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* 请使用spark将以上数据写入mysql中，并读取出来。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">data29</span> <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">textFile</span>(<span class="cm-string">"input20200407/users.txt"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">driver</span> <span class="cm-operator">=</span> <span class="cm-string">"com.mysql.jdbc.Driver"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">url</span> <span class="cm-operator">=</span> <span class="cm-string">"jdbc:mysql://localhost:3306/bigdata0407"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">username</span> <span class="cm-operator">=</span> <span class="cm-string">"root"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">password</span> <span class="cm-operator">=</span> <span class="cm-string">"root"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/**</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">* MySQL插入数据</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-variable">data29</span>.<span class="cm-variable">foreachPartition</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">data</span> <span class="cm-operator">=&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable-3">Class</span>.<span class="cm-variable">forName</span>(<span class="cm-variable">driver</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-keyword">val</span> <span class="cm-def">connection</span> <span class="cm-operator">=</span> <span class="cm-variable">java</span>.<span class="cm-variable">sql</span>.<span class="cm-variable">DriverManager</span>.<span class="cm-variable">getConnection</span>(<span class="cm-variable">url</span>, <span class="cm-variable">username</span>, <span class="cm-variable">password</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-keyword">val</span> <span class="cm-def">sql</span> <span class="cm-operator">=</span> <span class="cm-string">"INSERT INTO `user` values (NULL,?,?,?,?)"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" class="cm-tab-wrap-hack" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable">data</span>.<span class="cm-variable">foreach</span> {<span class="cm-tab" role="presentation" cm-text="	"> </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-variable">tuples</span> <span class="cm-operator">=&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-keyword">val</span> <span class="cm-def">datas</span> <span class="cm-operator">=</span> <span class="cm-variable">tuples</span>.<span class="cm-variable">split</span>(<span class="cm-string">" "</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-keyword">val</span> <span class="cm-def">statement</span> <span class="cm-operator">=</span> <span class="cm-variable">connection</span>.<span class="cm-variable">prepareStatement</span>(<span class="cm-variable">sql</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">statement</span>.<span class="cm-variable">setString</span>(<span class="cm-number">1</span>, <span class="cm-variable">datas</span>(<span class="cm-number">0</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">statement</span>.<span class="cm-variable">setString</span>(<span class="cm-number">2</span>, <span class="cm-variable">datas</span>(<span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">statement</span>.<span class="cm-variable">setString</span>(<span class="cm-number">3</span>, <span class="cm-variable">datas</span>(<span class="cm-number">2</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">statement</span>.<span class="cm-variable">setString</span>(<span class="cm-number">4</span>, <span class="cm-variable">datas</span>(<span class="cm-number">3</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">statement</span>.<span class="cm-variable">executeUpdate</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">statement</span>.<span class="cm-variable">close</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable">connection</span>.<span class="cm-variable">close</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/**</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">* MySQL查询数据</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">var</span> <span class="cm-def">sql</span> <span class="cm-operator">=</span> <span class="cm-string">"select * from `user` where id between ? and ?"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">jdbcRDD</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">JdbcRDD</span>(<span class="cm-variable">sc</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; () <span class="cm-operator">=&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable-3">Class</span>.<span class="cm-variable">forName</span>(<span class="cm-variable">driver</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable">java</span>.<span class="cm-variable">sql</span>.<span class="cm-variable">DriverManager</span>.<span class="cm-variable">getConnection</span>(<span class="cm-variable">url</span>, <span class="cm-variable">username</span>, <span class="cm-variable">password</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; },</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">sql</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-number">0</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-number">44</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-number">3</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">result</span> <span class="cm-operator">=&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-keyword">println</span>(<span class="cm-variable">s</span><span class="cm-string">"id=${result.getInt(1)},username=${result.getString(2)}"</span> <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-variable">s</span><span class="cm-string">",birthday=${result.getDate(3)},sex=${result.getString(4)},address=${result.getString(5)}"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> )</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-variable">jdbcRDD</span>.<span class="cm-variable">collect</span>() </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">/**</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* 30、在hbase中创建一个表student，有一个 message列族</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* create 'student', 'message'</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* scan 'student', {COLUMNS =&gt; 'message'}</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* 给出以下数据，请使用spark将数据写入到hbase中的student表中,并进行查询出来</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* 数据如下：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* 依次是：姓名 班级 性别 省份，对应表中的字段依次是：name,class,sex,province</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">//org.apache.hadoop.hbase.mapreduce.TableInputFormat</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">conf</span> <span class="cm-operator">=</span> <span class="cm-variable">HBaseConfiguration</span>.<span class="cm-variable">create</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-variable">conf</span>.<span class="cm-variable">set</span>(<span class="cm-string">"hbase.zookeeper.quorum"</span>, <span class="cm-string">"node01:2181,node02:2181,node03:2181"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-variable">conf</span>.<span class="cm-variable">set</span>(<span class="cm-variable">TableInputFormat</span>.<span class="cm-variable">INPUT_TABLE</span>, <span class="cm-string">"student"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">/**</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* HBase插入数据</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">dataRDD</span>: <span class="cm-variable">RDD</span>[<span class="cm-variable-3">String</span>] <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">textFile</span>(<span class="cm-string">"input20200407/student.txt"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">putRDD</span>: <span class="cm-variable">RDD</span>[(<span class="cm-variable">ImmutableBytesWritable</span>, <span class="cm-variable">Put</span>)] <span class="cm-operator">=</span> <span class="cm-variable">dataRDD</span>.<span class="cm-variable">map</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" class="cm-tab-wrap-hack" style="padding-right: 0.1px;"> &nbsp; <span class="cm-comment">//飞松<span class="cm-tab" role="presentation" cm-text="	"> </span>3<span class="cm-tab" role="presentation" cm-text="	">   </span>女<span class="cm-tab" role="presentation" cm-text="	">   </span>山东省</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-keyword">case</span> <span class="cm-variable">line</span> <span class="cm-operator">=&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-keyword">val</span> <span class="cm-def">datas</span> <span class="cm-operator">=</span> <span class="cm-variable">line</span>.<span class="cm-variable">split</span>(<span class="cm-string">"\t"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-keyword">val</span> <span class="cm-def">rowkey</span> <span class="cm-operator">=</span> <span class="cm-variable">Bytes</span>.<span class="cm-variable">toBytes</span>(<span class="cm-variable">datas</span>(<span class="cm-number">0</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-keyword">val</span> <span class="cm-def">put</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">Put</span>(<span class="cm-variable">rowkey</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable">put</span>.<span class="cm-variable">addColumn</span>(<span class="cm-variable">Bytes</span>.<span class="cm-variable">toBytes</span>(<span class="cm-string">"message"</span>), <span class="cm-variable">Bytes</span>.<span class="cm-variable">toBytes</span>(<span class="cm-string">"name"</span>), <span class="cm-variable">Bytes</span>.<span class="cm-variable">toBytes</span>(<span class="cm-variable">datas</span>(<span class="cm-number">0</span>)))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable">put</span>.<span class="cm-variable">addColumn</span>(<span class="cm-variable">Bytes</span>.<span class="cm-variable">toBytes</span>(<span class="cm-string">"message"</span>), <span class="cm-variable">Bytes</span>.<span class="cm-variable">toBytes</span>(<span class="cm-string">"class"</span>), <span class="cm-variable">Bytes</span>.<span class="cm-variable">toBytes</span>(<span class="cm-variable">datas</span>(<span class="cm-number">1</span>)))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable">put</span>.<span class="cm-variable">addColumn</span>(<span class="cm-variable">Bytes</span>.<span class="cm-variable">toBytes</span>(<span class="cm-string">"message"</span>), <span class="cm-variable">Bytes</span>.<span class="cm-variable">toBytes</span>(<span class="cm-string">"sex"</span>), <span class="cm-variable">Bytes</span>.<span class="cm-variable">toBytes</span>(<span class="cm-variable">datas</span>(<span class="cm-number">2</span>)))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable">put</span>.<span class="cm-variable">addColumn</span>(<span class="cm-variable">Bytes</span>.<span class="cm-variable">toBytes</span>(<span class="cm-string">"message"</span>), <span class="cm-variable">Bytes</span>.<span class="cm-variable">toBytes</span>(<span class="cm-string">"province"</span>), <span class="cm-variable">Bytes</span>.<span class="cm-variable">toBytes</span>(<span class="cm-variable">datas</span>(<span class="cm-number">3</span>)))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; (<span class="cm-keyword">new</span> <span class="cm-variable">ImmutableBytesWritable</span>(<span class="cm-variable">rowkey</span>), <span class="cm-variable">put</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">jobConf</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">JobConf</span>(<span class="cm-variable">conf</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">//org.apache.hadoop.hb8ase.mapred.TableOutputFormat</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-variable">jobConf</span>.<span class="cm-variable">setOutputFormat</span>(<span class="cm-variable">classOf</span>[<span class="cm-variable">TableOutputFormat</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-variable">jobConf</span>.<span class="cm-variable">set</span>(<span class="cm-variable">TableOutputFormat</span>.<span class="cm-variable">OUTPUT_TABLE</span>, <span class="cm-string">"student"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-variable">putRDD</span>.<span class="cm-variable">saveAsHadoopDataset</span>(<span class="cm-variable">jobConf</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">/**</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">* HBase查询数据</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">val</span> <span class="cm-def">hbaseRDD</span>: <span class="cm-variable">RDD</span>[(<span class="cm-variable">ImmutableBytesWritable</span>, <span class="cm-variable">Result</span>)] <span class="cm-operator">=</span> <span class="cm-variable">sc</span>.<span class="cm-variable">newAPIHadoopRDD</span>(<span class="cm-variable">conf</span>, <span class="cm-variable">classOf</span>[<span class="cm-variable">TableInputFormat</span>],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">classOf</span>[<span class="cm-variable">ImmutableBytesWritable</span>],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">classOf</span>[<span class="cm-variable">Result</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-variable">hbaseRDD</span>.<span class="cm-variable">foreach</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-keyword">case</span> (<span class="cm-variable">rowKey</span>, <span class="cm-variable">result</span>) <span class="cm-operator">=&gt;</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-keyword">val</span> <span class="cm-def">cells</span>: <span class="cm-variable-3">Array</span>[<span class="cm-variable">Cell</span>] <span class="cm-operator">=</span> <span class="cm-variable">result</span>.<span class="cm-variable">rawCells</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-keyword">for</span> (<span class="cm-variable">cell</span> <span class="cm-operator">&lt;-</span> <span class="cm-variable">cells</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-keyword">println</span>(<span class="cm-variable">Bytes</span>.<span class="cm-variable">toString</span>(<span class="cm-variable">CellUtil</span>.<span class="cm-variable">cloneRow</span>(<span class="cm-variable">cell</span>)) <span class="cm-operator">+</span> <span class="cm-string">"\t"</span> <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Bytes</span>.<span class="cm-variable">toString</span>(<span class="cm-variable">CellUtil</span>.<span class="cm-variable">cloneFamily</span>(<span class="cm-variable">cell</span>)) <span class="cm-operator">+</span> <span class="cm-string">"\t"</span> <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Bytes</span>.<span class="cm-variable">toString</span>(<span class="cm-variable">CellUtil</span>.<span class="cm-variable">cloneQualifier</span>(<span class="cm-variable">cell</span>)) <span class="cm-operator">+</span> <span class="cm-string">"\t"</span> <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Bytes</span>.<span class="cm-variable">toString</span>(<span class="cm-variable">CellUtil</span>.<span class="cm-variable">cloneValue</span>(<span class="cm-variable">cell</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; )</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> }</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 6609px;"></div><div class="CodeMirror-gutters" style="display: none; height: 6609px;"></div></div></div></pre><p>&nbsp;</p></div></div>
</body>
</html>